
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="网络安全工程师的学习笔记">
      
      
        <meta name="author" content="Josh">
      
      
        <link rel="canonical" href="https://Superior-Josh.github.io/Cyber-Security-Engineer/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E5%AE%89%E5%85%A8/%E5%AF%86%E7%A0%81%E5%AD%A6/">
      
      
        <link rel="prev" href="../SQLmap/">
      
      
        <link rel="next" href="../%E6%BC%8F%E6%B4%9E/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>密码学 - 网络安全工程师的学习笔记</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="网络安全工程师的学习笔记" class="md-header__button md-logo" aria-label="网络安全工程师的学习笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            网络安全工程师的学习笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              密码学
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="teal"  aria-label="切换到深色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到深色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="切换到浅色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到浅色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/" class="md-tabs__link">
          
  
  
  编程语言

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/Linux/" class="md-tabs__link">
          
  
  
  计算机基础

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../AI%20%E5%AE%89%E5%85%A8/" class="md-tabs__link">
          
  
  
  网络空间安全

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E6%B5%8B%E8%AF%95/Black-box%20Testing/" class="md-tabs__link">
          
  
  
  测试

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="网络安全工程师的学习笔记" class="md-nav__button md-logo" aria-label="网络安全工程师的学习笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    网络安全工程师的学习笔记
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    编程语言
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            编程语言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    计算机基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            计算机基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/Linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据结构与算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络协议
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机操作系统
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    网络空间安全
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            网络空间安全
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI%20%E5%AE%89%E5%85%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI 安全
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metasploit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metasploit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SonarQube/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SonarQube
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SQLmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQLmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    密码学
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    密码学
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      分组密码
    </span>
  </a>
  
    <nav class="md-nav" aria-label="分组密码">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aes" class="md-nav__link">
    <span class="md-ellipsis">
      AES
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AES">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aes_1" class="md-nav__link">
    <span class="md-ellipsis">
      AES 参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aes_2" class="md-nav__link">
    <span class="md-ellipsis">
      AES 操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AES 操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aes_3" class="md-nav__link">
    <span class="md-ellipsis">
      AES 的字节操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      字节代换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      行移位
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      列混淆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      轮密钥加
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      密钥调度
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sm4" class="md-nav__link">
    <span class="md-ellipsis">
      SM4
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SM4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      核心定位与特性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      算法原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      与国际算法对比
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      分组密码的工作模式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="分组密码的工作模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pkcs7" class="md-nav__link">
    <span class="md-ellipsis">
      PKCS#7填充
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecb" class="md-nav__link">
    <span class="md-ellipsis">
      ECB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cbc" class="md-nav__link">
    <span class="md-ellipsis">
      CBC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cfb" class="md-nav__link">
    <span class="md-ellipsis">
      CFB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ofb" class="md-nav__link">
    <span class="md-ellipsis">
      OFB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctr" class="md-nav__link">
    <span class="md-ellipsis">
      CTR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      加密系统的安全性
    </span>
  </a>
  
    <nav class="md-nav" aria-label="加密系统的安全性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      加密系统安全性的定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ind-cpa" class="md-nav__link">
    <span class="md-ellipsis">
      IND-CPA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ind-cca" class="md-nav__link">
    <span class="md-ellipsis">
      IND-CCA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hash" class="md-nav__link">
    <span class="md-ellipsis">
      Hash 函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hash 函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md5" class="md-nav__link">
    <span class="md-ellipsis">
      MD5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sha" class="md-nav__link">
    <span class="md-ellipsis">
      SHA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sm3" class="md-nav__link">
    <span class="md-ellipsis">
      SM3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SM3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      算法核心原理与运算流程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="算法核心原理与运算流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      第一阶段：消息预处理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第一阶段：消息预处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      消息填充
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      消息分组
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      第二阶段：迭代压缩
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第二阶段：迭代压缩">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      初始哈希值设置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      消息扩展
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      压缩函数运算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      第三阶段：输出变换
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sm3_1" class="md-nav__link">
    <span class="md-ellipsis">
      SM3与国际算法的核心差异
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      公钥密码
    </span>
  </a>
  
    <nav class="md-nav" aria-label="公钥密码">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rsa" class="md-nav__link">
    <span class="md-ellipsis">
      RSA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RSA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      公钥与私钥
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      加密
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      解密
    </span>
  </a>
  
    <nav class="md-nav" aria-label="解密">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      原理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ind-cparsa" class="md-nav__link">
    <span class="md-ellipsis">
      IND-CPA安全结构：使用RSA加密
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa_1" class="md-nav__link">
    <span class="md-ellipsis">
      可以直接使用 RSA 实现单向安全吗
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pkcs-1v15" class="md-nav__link">
    <span class="md-ellipsis">
      填充:PKCS ##1v1:5
    </span>
  </a>
  
    <nav class="md-nav" aria-label="填充:PKCS ##1v1:5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bleichenbacher" class="md-nav__link">
    <span class="md-ellipsis">
      选择密文攻击：Bleichenbacher 攻击
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ind-ccaoaep" class="md-nav__link">
    <span class="md-ellipsis">
      IND-CCA安全结构：最优非对称加密（OAEP）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elgamal" class="md-nav__link">
    <span class="md-ellipsis">
      ElGamal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rabin" class="md-nav__link">
    <span class="md-ellipsis">
      Rabin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecc" class="md-nav__link">
    <span class="md-ellipsis">
      ECC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sm2" class="md-nav__link">
    <span class="md-ellipsis">
      SM2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SM2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      算法核心定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      核心运算流程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="核心运算流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      数字签名与验证
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数字签名与验证">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      签名生成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      签名验证
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      密钥交换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      数据加密与解密
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数据加密与解密">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      加密
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      解密
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      数字签名
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数字签名">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rsa_2" class="md-nav__link">
    <span class="md-ellipsis">
      RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elgamal_1" class="md-nav__link">
    <span class="md-ellipsis">
      Elgamal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsa" class="md-nav__link">
    <span class="md-ellipsis">
      DSA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      密码协议
    </span>
  </a>
  
    <nav class="md-nav" aria-label="密码协议">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      密钥分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      密钥协商
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      秘密共享
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      身份识别
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      零知识证明
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      密码学工具
    </span>
  </a>
  
    <nav class="md-nav" aria-label="密码学工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openssl" class="md-nav__link">
    <span class="md-ellipsis">
      openssl
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%BC%8F%E6%B4%9E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    漏洞
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络安全设备
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络攻防
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    测试
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            测试
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%B5%8B%E8%AF%95/Black-box%20Testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Black-box Testing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>密码学</h1>

<h2 id="_1">分组密码<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="aes">AES<a class="headerlink" href="#aes" title="Permanent link">&para;</a></h3>
<h4 id="aes_1">AES 参数<a class="headerlink" href="#aes_1" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>块大小128</p>
</li>
<li>
<p>密钥大小为128、192和256位</p>
</li>
<li>
<p>每个密钥大小为10、12或14轮加密</p>
</li>
</ul>
<p>以 AES-128 为例。</p>
<p>AES是一个替换置换网络（不是Feistel网络）。</p>
<p>首先将消息安排在元素为8比特的4 × 4矩阵中，向下填充，然后向右填充。</p>
<h4 id="aes_2">AES 操作<a class="headerlink" href="#aes_2" title="Permanent link">&para;</a></h4>
<ul>
<li>字节代换（S盒）：对每个字节进行独立操作。这就给出了 AES 的非线性和混淆。</li>
<li>字节排列：行移位</li>
<li>列操作：列混淆</li>
</ul>
<blockquote>
<p>行移位和列混淆提供了 AES 中的扩散。</p>
</blockquote>
<ul>
<li>轮密钥加</li>
</ul>
<p>这 10 轮加密过程之前会有一次密钥加法（因此，总共有 11 次密钥加法）。最后一轮稍有不同：没有列混淆操作。</p>
<p><img src="../../img/AES.png" alt="AES" style="zoom:50%;" /></p>
<h5 id="aes_3">AES 的字节操作<a class="headerlink" href="#aes_3" title="Permanent link">&para;</a></h5>
<p>AES 是一种面向字节的加密算法。被各轮操作处理的 128 位“状态”（state）被视为 16 个字节，并排列成一个矩阵的形式：</p>
<p><img src="../../img/AES_matrix.png" alt="AES_matrix" style="zoom:80%;" /></p>
<ul>
<li>
<p><span class="arithmatex">\(\oplus\)</span> ：按位异或</p>
</li>
<li>
<p><span class="arithmatex">\(\otimes\)</span> ：<span class="arithmatex">\(F_{2^8}\)</span>上的乘法 <span class="arithmatex">\(F_2[x]\)</span></p>
</li>
</ul>
<p>如：</p>
<p>$
  \begin{aligned}
    0x53 \otimes 0xCA / (x^8 + x^4 + x^3 + x + 1) &amp;= (x^6+x^4+x+1)(x^7+x^6+x^3+x)/(x^8 + x^4 + x^3 + x + 1) \
    &amp;= 0x01
  \end{aligned}
  $</p>
<h5 id="_2">字节代换<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h5>
<p><img src="../../img/AES-SubBytes.svg.png" alt="AES-SubBytes.svg" style="zoom: 25%;" /></p>
<p>矩阵中的各字节透过一个8位的<a href="https://en.wikipedia.org/wiki/Rijndael_S-box#Forward_S-box">S-box</a>进行转换。这个步骤提供了非线性的变换能力。</p>
<h5 id="_3">行移位<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h5>
<p><img src="../../img/AES-ShiftRows.svg.png" alt="AES-ShiftRows.svg" style="zoom: 33%;" /></p>
<h5 id="_4">列混淆<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h5>
<p><img src="../../img/AES-MixColumns.svg.png" alt="AES-MixColumns.svg" style="zoom: 25%;" /></p>
<p>将每一列分别混合，通过与矩阵相乘来实现：</p>
<p><img src="../../img/AES_matrix_times.png" alt="AES_matrix_times" style="zoom: 67%;" /></p>
<p>每一列的四个字节透过<a href="https://zh.wikipedia.org/wiki/线性变换">线性变换</a>互相结合。每一列的四个元素分别当作 <span class="arithmatex">\(1,x,x_2,x_3\)</span> 的系数，合并即为 <span class="arithmatex">\(GF(2^8)\)</span> 中的一个多项式，接着将此多项式和一个固定的多项式 <span class="arithmatex">\(c(x)=3x^3+x^2+x+2\)</span> 在模 <span class="arithmatex">\(x^4+1\)</span> 下相乘。</p>
<h5 id="_5">轮密钥加<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h5>
<p><img src="../../img/AES-AddRoundKey.svg.png" alt="AES-AddRoundKey.svg" style="zoom: 33%;" /></p>
<h4 id="_6">密钥调度<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<p>派生轮密钥 <span class="arithmatex">\(K_i\)</span> 的方法如下：将 <span class="arithmatex">\(K\)</span> 分成四个字 <span class="arithmatex">\(W_0,W_1,W_2\)</span> 和 <span class="arithmatex">\(W_3\)</span> 各32位。</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nl">T</span><span class="p">:</span><span class="o">=</span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="mi">-1</span><span class="p">]</span><span class="o">&lt;&lt;&lt;</span><span class="mi">8</span>
<span class="w">    </span><span class="nl">T</span><span class="p">:</span><span class="o">=</span><span class="n">SubBytes</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="w">    </span><span class="nl">T</span><span class="p">:</span><span class="o">=</span><span class="n">T</span><span class="err">⊕</span><span class="n">RC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="w">    </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="p">]</span><span class="o">:=</span><span class="w"> </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="err">−</span><span class="mi">4</span><span class="p">]</span><span class="err">⊕</span><span class="n">T</span>
<span class="w">    </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">:=</span><span class="w"> </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="err">−</span><span class="mi">3</span><span class="p">]</span><span class="err">⊕</span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="p">]</span>
<span class="w">    </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">:=</span><span class="w"> </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="err">−</span><span class="mi">2</span><span class="p">]</span><span class="err">⊕</span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">:=</span><span class="w"> </span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="err">−</span><span class="mi">1</span><span class="p">]</span><span class="err">⊕</span><span class="n">W</span><span class="p">[</span><span class="mi">4</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
<span class="n">end</span>
</code></pre></div>
<ul>
<li>
<p>轮密钥<span class="arithmatex">\(K_i = W_{4i}, W_{4i+1}, W_{4i+2}, W_{4i+3}\)</span></p>
</li>
<li>
<p>常数 <span class="arithmatex">\(RC_i=0x\space rc_i000000\)</span></p>
</li>
</ul>
<p><span class="arithmatex">\(rc_i=x^{i-1}\bmod x^8 + x^4 + x^3 + x + 1\)</span></p>
<h3 id="sm4">SM4<a class="headerlink" href="#sm4" title="Permanent link">&para;</a></h3>
<h4 id="_7">核心定位与特性<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<p>SM4全称为“SM4分组密码算法”，由国家密码管理局发布，标准号为GB/T 32907-2016，其核心定位是满足国内商用领域的数据加密需求，替代部分国外算法实现自主可控。</p>
<p>其核心特性主要包括三点：</p>
<ol>
<li><strong>分组与密钥长度固定</strong>：分组长度和密钥长度均为128位，这一设计平衡了安全性和计算效率，能有效抵御常见的密码分析攻击。</li>
<li><strong>对称密码体制</strong>：加密和解密使用相同的密钥，操作流程对称，便于硬件和软件快速实现，适合对处理速度有要求的场景。</li>
<li><strong>国产化自主可控</strong>：算法设计完全由国内团队完成，无外部后门风险，符合国家信息安全战略，是政务、金融等关键领域的首选加密算法之一。</li>
</ol>
<h4 id="_8">算法原理<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>SM4算法是一种典型的迭代型分组密码，基于“代换-置换网络（Substitution-Permutation Network，SPN）”结构设计，其核心设计思路是通过多轮次的非线性代换（混淆）和线性置换（扩散）操作，将明文数据转化为完全不可识别的密文，同时保证加密与解密过程的对称性和高效性。整体加密流程可细分为<strong>初始变换</strong>、<strong>32轮轮函数迭代</strong>、<strong>反初始变换</strong>三个核心阶段，而支撑整个流程的关键还有<strong>密钥扩展算法</strong>，用于生成每轮迭代所需的轮密钥。</p>
<ol>
<li>
<p><strong>轮函数迭代（核心执行环节）</strong>：轮函数是SM4加密的核心模块，32轮迭代过程采用完全相同的结构，每轮操作都实现一次“混淆-扩散”循环。具体流程如下：首先，将128位明文分组划分为4个32位的字，记为X₀、X₁、X₂、X₃（后续每轮迭代的输入均为4个32位字）；然后，取后3个输入字Xᵢ₊₁、Xᵢ₊₂、Xᵢ₊₃与本轮轮密钥rkᵢ进行“轮函数F”运算，得到的结果再与第一个输入字Xᵢ进行异或（XOR）操作，生成新的字Xᵢ₊₄，同时将Xᵢ₊₁、Xᵢ₊₂、Xᵢ₊₃、Xᵢ₊₄作为下一轮迭代的输入，依次循环32轮。其中“轮函数F”包含四个关键子操作，按顺序执行： </p>
</li>
<li>
<p><strong>字节代换（S盒变换）</strong>：这是实现非线性混淆的核心步骤。将32位输入字拆分为4个8位字节，每个字节通过SM4专用S盒进行查表替换。S盒是基于GF(2⁸)有限域上的逆运算和仿射变换设计的，具有良好的非线性特性和抗差分攻击能力，能有效打破输入与输出之间的线性关联； </p>
</li>
<li>
<p><strong>行移位（字节移位）</strong>：对S盒输出的4个字节进行循环移位操作，第一个字节不移位，第二个字节左移1个字节，第三个字节左移2个字节，第四个字节左移3个字节。该操作通过位置置换实现字节级别的扩散，使单个字节的变化影响到多个位置； 3. <strong>列混合（线性变换）</strong>：对行移位后的4个字节进行线性变换，通过固定的线性矩阵与字节向量相乘（基于GF(2)域运算），将单个字节的信息扩散到整个32位字中，进一步增强数据的扩散效果； </p>
</li>
<li>
<p><strong>轮密钥加（异或操作）</strong>：将列混合后的32位结果与本轮轮密钥rkᵢ进行异或运算，实现密钥信息与明文信息的深度融合。32轮迭代完成后，得到的4个32位字X₃₂、X₃₃、X₃₄、X₃₅需经过“反初始变换”（即将4个字按X₃₅、X₃₄、X₃₃、X₃₂的顺序重组为128位数据），最终得到128位密文。</p>
</li>
<li>
<p><strong>密钥扩展算法（轮密钥生成）</strong>：SM4的加密和解密均依赖128位主密钥，但每轮轮函数需要独立的32位轮密钥，因此需通过密钥扩展算法将128位主密钥扩展为32个32位轮密钥（rk₀至rk₃₁）。具体步骤为：首先将128位主密钥拆分为4个32位字MK₀、MK₁、MK₂、MK₃，与4个固定的32位系统参数FK₀、FK₁、FK₂、FK₃分别异或，得到密钥扩展的初始输入字K₀、K₁、K₂、K₃；然后采用与轮函数类似的迭代方式生成后续密钥字，对于第i轮（i从0到31），取前4个密钥字中的后3个（Kᵢ₊₁、Kᵢ₊₂、Kᵢ₊₃）与一个固定的32位常量CKᵢ进行“密钥扩展函数G”运算，结果再与第一个密钥字Kᵢ异或，得到新的密钥字Kᵢ₊₄，其中Kᵢ₊₄即为第i轮的轮密钥rkᵢ。“密钥扩展函数G”同样包含S盒字节代换和线性变换操作，确保生成的轮密钥具有良好的随机性和独立性，避免因主密钥泄露或轮密钥关联性导致的安全风险。</p>
</li>
<li>
<p><strong>解密原理（对称结构设计）</strong>：SM4的解密过程与加密过程在结构上完全对称，核心优势是无需重新生成解密密钥，仅需将加密时使用的32个轮密钥按逆序（即rk₃₁至rk₀）使用即可。这是因为轮函数具有“可逆性”——字节代换的逆操作可通过S盒的逆表实现，行移位的逆操作是反向循环移位，列混合的逆操作可通过逆线性矩阵实现，而异或操作本身是自逆的。因此，解密时只需将密文作为输入，按加密的反向流程执行32轮迭代（使用逆序轮密钥），再经过初始变换（与加密的反初始变换对称），即可还原出原始明文，这种对称设计极大简化了算法的硬件和软件实现复杂度。</p>
</li>
</ol>
<h4 id="_9">与国际算法对比<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>目前国际上主流的分组密码算法是AES，SM4与AES在设计和应用上既有共性，也存在显著差异，具体对比如下：</p>
<table>
<thead>
<tr>
<th>对比维度</th>
<th>SM4算法</th>
<th>AES算法</th>
</tr>
</thead>
<tbody>
<tr>
<td>设计主体</td>
<td>中国国家密码管理局</td>
<td>美国国家标准与技术研究院（NIST）</td>
</tr>
<tr>
<td>分组/密钥长度</td>
<td>均固定为128位</td>
<td>分组128位，密钥支持128/192/256位</td>
</tr>
<tr>
<td>算法结构</td>
<td>32轮SPN结构</td>
<td>10/12/14轮SPN结构（依密钥长度）</td>
</tr>
<tr>
<td>安全性</td>
<td>抵御差分、线性等攻击，无公开安全漏洞</td>
<td>国际公认安全，应用广泛，经过长期验证</td>
</tr>
<tr>
<td>适用场景</td>
<td>国内政务、金融、物联网等需国产化合规的领域</td>
<td>全球通用，适用于互联网、跨境业务等国际场景</td>
</tr>
</tbody>
</table>
<h4 id="_10"><a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<h3 id="_11">分组密码的工作模式<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>一个好的分组密码模式应该具有以下属性：</p>
<ol>
<li>安全性（保密性）：相同的明文不应产生相同的密文；明文中的相同块不应该产生相同的密文块。</li>
<li>安全性（完整性）：应该有防止删除或插入块的保护。</li>
<li>恢复：密文传输错误应该只影响包含错误的块。</li>
<li>效率：它应该是有效率的（例如，可并行）。</li>
</ol>
<h4 id="pkcs7">PKCS#7填充<a class="headerlink" href="#pkcs7" title="Permanent link">&para;</a></h4>
<p>PKCS#7 标准规定，填充字节的值等于填充的长度（如填充 6 字节则每个字节为<code>0x06</code>），解密时通过最后一个字节的值即可知道需要去除多少填充。</p>
<h4 id="ecb">ECB<a class="headerlink" href="#ecb" title="Permanent link">&para;</a></h4>
<p>电码本模式</p>
<ul>
<li>加密：</li>
</ul>
<p><img src="../../img/Ecb_encryption.png" alt="Ecb_encryption" style="zoom: 80%;" /></p>
<ul>
<li>解密：</li>
</ul>
<p><img src="../../img/Ecb_decryption.png" alt="Ecb_decryption" style="zoom: 80%;" /></p>
<ul>
<li>特点：</li>
<li>加密可以并行计算。</li>
<li>明文块<span class="arithmatex">\(m_i\)</span>的改变只会影响到密文块<span class="arithmatex">\(c_i\)</span>的改变。</li>
<li>密文块在传输中单个比特出错只会影响到该块的解密。</li>
<li>相同的明文产生相同的密文，容易暴露出明文的数据格式，不能抵抗替换攻击（篡改）。因此该模式适合加密短数据，如一个会话密钥。</li>
</ul>
<h4 id="cbc">CBC<a class="headerlink" href="#cbc" title="Permanent link">&para;</a></h4>
<p>密码分组链接模式</p>
<ul>
<li>加密：</li>
</ul>
<p><img src="../../img/Cbc_encryption.png" alt="Cbc_encryption" style="zoom: 80%;" /></p>
<p>​   <span class="arithmatex">\(C_i=E_k(P_i \oplus C_{i-1} )\)</span></p>
<p>​   <span class="arithmatex">\(C_0=IV\)</span></p>
<ul>
<li>解密：</li>
</ul>
<p><img src="../../img/Cbc_decryption.png" alt="Cbc_decryption" style="zoom:80%;" /></p>
<p>​   <span class="arithmatex">\(P_i=D_k(C_i) \oplus C_{i-1}\)</span></p>
<p>​   <span class="arithmatex">\(C_0=IV\)</span></p>
<ul>
<li>特点：</li>
<li>每次加密都应该随机选择IV。</li>
<li>必须将IV与密文一起存储，否则无法解密。因此，IV是<em>随机的</em>，但不是<em>秘密的</em>。</li>
<li>由于密文包含IV，因此它比明文长一个块。所以在长度上有小扩展。</li>
<li>相同的明文块产生的密文块可能不同，</li>
<li>明文块<span class="arithmatex">\(m_i\)</span>发生改变将引起后面所有密文块发生改变。</li>
<li>密文块<span class="arithmatex">\(c_i\)</span>依赖于明文块<span class="arithmatex">\(m_i\)</span>以及所有前面的明文块。</li>
<li>密文块<span class="arithmatex">\(c_i\)</span>中单个比特出错会影响后续至多两个密文块<span class="arithmatex">\(c_i\)</span>和<span class="arithmatex">\(c_{i+1}\)</span>的解密，具有有限的错误传播特性。</li>
</ul>
<h4 id="cfb">CFB<a class="headerlink" href="#cfb" title="Permanent link">&para;</a></h4>
<p>密码反馈模式</p>
<ul>
<li>
<p>加密</p>
</li>
<li>
<p>解密</p>
</li>
<li>
<p>特点：</p>
</li>
<li></li>
</ul>
<h4 id="ofb">OFB<a class="headerlink" href="#ofb" title="Permanent link">&para;</a></h4>
<p>输出反馈模式</p>
<ul>
<li>
<p>加密</p>
</li>
<li>
<p>解密</p>
</li>
<li>
<p>特点：</p>
</li>
<li></li>
</ul>
<h4 id="ctr">CTR<a class="headerlink" href="#ctr" title="Permanent link">&para;</a></h4>
<p>计数器模式</p>
<ul>
<li>加密：</li>
</ul>
<p><img src="../../img/Ctr_encryption.png" alt="Ctr_encryption" style="zoom:80%;" /></p>
<ul>
<li>解密：</li>
</ul>
<p><img src="../../img/Ctr_decryption.png" alt="Ctr_decryption" style="zoom:80%;" /></p>
<ul>
<li>特点：</li>
<li>计数器<span class="arithmatex">\(CTR_1\)</span>, ..., <span class="arithmatex">\(CTR_t\)</span>互不相同，这样可以保证相同的明文块产生不同的密文块。</li>
<li>由于加密计数器时不需要明文，因此可以预处理来提高加密速度。</li>
<li>可以并行计算。</li>
</ul>
<h3 id="_12">加密系统的安全性<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<h4 id="_13">加密系统安全性的定义<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<ol>
<li>给定一个密文，攻击者（在没有密钥的情况下）绝对无法获得明文。</li>
<li>不安全，如 3DES 会泄露明文块是否相同。</li>
<li>给定一个密文，攻击者可以仅通过 <span class="arithmatex">\(N\)</span> 单位的工作量获得明文。</li>
<li>
<p>不安全，攻击者可能足够幸运猜出密钥。</p>
</li>
<li>
<p>给定一个密文，攻击者要么通过消耗 <span class="arithmatex">\(N\)</span> 单位的工作量获得明文，要么以最多 <span class="arithmatex">\(\frac{1}{M}\)</span> 的概率猜测明文或密钥。</p>
</li>
<li>
<p>不安全，攻击者可以获得关于明文内容的统计信息。</p>
</li>
<li>
<p>给定一个密文，攻击者不能推测明文的<strong>任何信息</strong>，除非消耗 <span class="arithmatex">\(N\)</span> 单位的工作量获得明文，或者以最多 <span class="arithmatex">\(\frac{1}{M}\)</span> 的概率猜测明文或密钥。</p>
</li>
</ol>
<h4 id="ind-cpa">IND-CPA<a class="headerlink" href="#ind-cpa" title="Permanent link">&para;</a></h4>
<p>基于选择明文攻击的不可区分性</p>
<ol>
<li>挑战者：<span class="arithmatex">\(k\)</span> --&gt; 攻击者</li>
<li>攻击者：<span class="arithmatex">\(m_0,m_1\)</span> --&gt; 挑战者</li>
<li>挑战者：<span class="arithmatex">\(b\in \{0,1\}\)</span>, <span class="arithmatex">\(Enc_k(m_b)\)</span> --&gt;攻击者</li>
<li>攻击者：<span class="arithmatex">\(b'\)</span> --&gt; 挑战者</li>
<li>if <span class="arithmatex">\(b'=b\)</span>，挑战者获胜</li>
</ol>
<h4 id="ind-cca">IND-CCA<a class="headerlink" href="#ind-cca" title="Permanent link">&para;</a></h4>
<p>基于选择密文攻击的不可区分性</p>
<ol>
<li>挑战者：生成<span class="arithmatex">\((pk,sk)\)</span>, <span class="arithmatex">\(pk\)</span> --&gt; 攻击者</li>
<li>攻击者：若干个<span class="arithmatex">\(c\)</span> --&gt; 挑战者</li>
<li>挑战者：<span class="arithmatex">\(m=Dec(sk,c)\)</span> --&gt; 攻击者</li>
<li>攻击者：<span class="arithmatex">\(m_0,m_1\)</span> --&gt; 挑战者</li>
<li>挑战者：<span class="arithmatex">\(b\in \{0,1\}\)</span>, <span class="arithmatex">\(c^* = Enc(pk, m_b)\)</span> --&gt; 攻击者</li>
<li>攻击者可以再次进行解密查询，但不能查询挑战密文 <span class="arithmatex">\(c^*\)</span> 的解密结果。</li>
<li>攻击者：<span class="arithmatex">\(b^*\)</span> --&gt; 挑战者</li>
<li>if <span class="arithmatex">\(b'=b\)</span>，挑战者获胜</li>
<li>如果在多次实验中，无论攻击者的策略如何，其成功概率都不能显著超过随机猜测（50%），则加密方案是 <strong>IND-CCA 安全的</strong>，。</li>
</ol>
<h2 id="hash">Hash 函数<a class="headerlink" href="#hash" title="Permanent link">&para;</a></h2>
<p>性质：
1. 输入任意长
2. 输出固定长
3. 对任意给定的<span class="arithmatex">\(x\)</span>，计算<span class="arithmatex">\(h(x)\)</span>比较容易
4.    </p>
<h3 id="md5">MD5<a class="headerlink" href="#md5" title="Permanent link">&para;</a></h3>
<h3 id="sha">SHA<a class="headerlink" href="#sha" title="Permanent link">&para;</a></h3>
<h3 id="sm3">SM3<a class="headerlink" href="#sm3" title="Permanent link">&para;</a></h3>
<p>SM3是我国自主设计的密码杂凑算法（哈希算法），于2010年与SM2一同成为国家密码标准（GB/T 32905-2016），是我国商用密码体系的核心组成部分之一。其核心功能是将任意长度的输入数据（明文）映射为固定长度（256位）的输出数据（哈希值/摘要），具有抗碰撞性、抗原像性等关键安全特性，广泛配合SM2等算法使用，为数字签名、数据完整性校验、密钥派生等场景提供基础安全保障。</p>
<p>SM3是一种迭代型密码杂凑算法，基于Merkle-Damgård结构设计，通过固定的运算步骤将任意长度的输入消息压缩为256位的哈希值。与国际通用的SHA-256算法相比，SM3在运算逻辑、轮函数设计上存在差异，但安全强度等效，且更适配我国密码体系的协同需求，常与SM2（签名/加密）、SM4（对称加密）协同工作，形成完整的密码保障链条。</p>
<h4 id="_14">算法核心原理与运算流程<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p>SM3的运算流程遵循迭代型杂凑算法的通用框架，分为“消息预处理”和“迭代压缩”两大阶段，最终通过“输出变换”得到256位哈希值。每个阶段的具体步骤如下：</p>
<h5 id="_15">第一阶段：消息预处理<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h5>
<p>预处理的目的是将任意长度的原始消息转换为固定长度的消息块序列，为后续迭代压缩做准备，包括“消息填充”和“消息分组”两个步骤。</p>
<h6 id="_16">消息填充<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h6>
<p>填充的核心要求是使消息总长度满足“对512取余等于448”，具体步骤：</p>
<ol>
<li>在原始消息M后添加一个“1”比特，即二进制的“1”；</li>
<li>在“1”后添加若干个“0”比特，添加的数量k满足“(原始消息长度 + 1 + k) mod 512 = 448”，k的取值范围为0≤k≤511；</li>
<li>在填充的“0”后添加一个64位的整数，该整数表示原始消息M的长度（单位：比特），若原始消息长度超过2^64比特，仅取低64位。</li>
</ol>
<p>示例：若原始消息长度为1比特（值为“0”），则填充过程为：添加“1”→添加446个“0”→添加64位长度值“0x0000000000000001”，最终填充后消息长度为512比特（448+64）。</p>
<h6 id="_17">消息分组<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h6>
<p>将填充后的消息按512比特（64字节）为一个分组，划分为若干个消息块M_0, M_1, ..., M_{n-1}，若填充后消息长度为L，则n = L / 512，且n≥1。每个消息块将作为后续迭代压缩的输入单元。</p>
<h5 id="_18">第二阶段：迭代压缩<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h5>
<p>迭代压缩是SM3的核心环节，以512位消息块为单位，通过“压缩函数f”对初始哈希值进行迭代更新，最终得到中间哈希值。该阶段涉及“初始值设置”“消息扩展”“压缩函数运算”三个关键步骤。</p>
<h6 id="_19">初始哈希值设置<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h6>
<p>SM3的初始哈希值（IV）为8个32位寄存器，其初始值由标准规定，采用十六进制表示为：</p>
<p>IV = (A, B, C, D, E, F, G, H) = (0x7380166F, 0x4914B2B9, 0x172442D7, 0xDA8A0600, 0xA96F30BC, 0x163138AA, 0xE38DEE4D, 0xB0FB0E4E)</p>
<p>这8个初始值是经过安全设计的固定常量，确保迭代压缩的初始状态具有随机性和安全性。</p>
<h6 id="_20">消息扩展<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h6>
<p>为增强算法的抗攻击能力，SM3将每个512位消息块M_i扩展为132个32位字W_0, W_1, ..., W_131，分为“前68个字扩展”和“后64个字扩展”两部分：</p>
<ol>
<li><strong>前68个字生成（W_0至W_67）</strong>：将512位消息块M_i按32位为单位划分为16个字W_0至W_15；对于W_j（16≤j≤67），通过以下公式计算：W_j = P1(W_{j-16} ⊕ W_{j-9} ⊕ (W_{j-3} &lt;&lt; 15)) ⊕ (W_{j-13} &lt;&lt; 7) ⊕ W_{j-6}。其中P1为置换函数，定义为P1(X) = X ⊕ (X &lt;&lt; 15) ⊕ (X &lt;&lt; 23)，“⊕”为异或运算，“&lt;&lt;”为左移运算。</li>
<li><strong>后64个字生成（W_68至W_131）</strong>：对于W_j（68≤j≤131），通过公式W_j = W_{j-64} ⊕ W_{j-68}计算，用于后续压缩函数的轮运算。</li>
</ol>
<h6 id="_21">压缩函数运算<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h6>
<p>压缩函数f以初始哈希值（或上一轮迭代的输出哈希值）和扩展后的132个字为输入，经过64轮迭代运算更新8个32位寄存器的值，得到本轮迭代的输出哈希值。具体步骤：</p>
<ol>
<li>将上一轮输出的哈希值（初始轮为IV）赋值给8个临时寄存器：a=A, b=B, c=C, d=D, e=E, f=F, g=G, h=H；</li>
<li>进行64轮轮运算，每一轮以W_j和W_{j+68}（j从0到63）为输入，通过轮函数更新a-h的值。轮函数的核心是“布尔函数”和“置换运算”，其中布尔函数根据轮数不同分为FF_j和GG_j：        当0≤j≤15时，FF_j(X,Y,Z) = X ⊕ Y ⊕ Z，GG_j(X,Y,Z) = X ⊕ Y ⊕ Z；</li>
<li>当16≤j≤63时，FF_j(X,Y,Z) = (X ∧ Y) ∨ (X ∧ Z) ∨ (Y ∧ Z)，GG_j(X,Y,Z) = (X ∧ Y) ∨ (¬X ∧ Z)；</li>
<li>64轮运算结束后，将a-h分别与初始的A-H进行异或，得到本轮迭代的输出哈希值（A', B', C', D', E', F', G', H'），该值将作为下一个消息块的输入哈希值。</li>
</ol>
<h5 id="_22">第三阶段：输出变换<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h5>
<p>当所有消息块均完成迭代压缩后，最后一轮的输出哈希值（8个32位寄存器值）直接拼接为256位的最终哈希值，即SM3(M) = A' || B' || C' || D' || E' || F' || G' || H'（“||”表示字节拼接）。</p>
<h4 id="sm3_1">SM3与国际算法的核心差异<a class="headerlink" href="#sm3_1" title="Permanent link">&para;</a></h4>
<p>作为256位安全级别的杂凑算法，SM3常与国际通用的SHA-256对比，两者在安全强度上等效，但在设计细节和应用场景上存在显著差异，具体对比如下：</p>
<table>
<thead>
<tr>
<th style="text-align: left;">对比维度</th>
<th style="text-align: left;">SM3</th>
<th style="text-align: left;">SHA-256</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">标准归属</td>
<td style="text-align: left;">中国国家密码标准（GB/T 32905-2016）</td>
<td style="text-align: left;">美国NIST标准（FIPS 180-4）</td>
</tr>
<tr>
<td style="text-align: left;">消息扩展</td>
<td style="text-align: left;">将512位块扩展为132个32位字，含P1置换函数，扩展逻辑更复杂</td>
<td style="text-align: left;">将512位块扩展为64个32位字，无额外置换函数，扩展逻辑相对简洁</td>
</tr>
<tr>
<td style="text-align: left;">轮函数设计</td>
<td style="text-align: left;">64轮运算，布尔函数FF_j、GG_j分两段设计，含P0/P1置换</td>
<td style="text-align: left;">64轮运算，布尔函数Ch、Maj固定，无额外置换</td>
</tr>
<tr>
<td style="text-align: left;">初始哈希值</td>
<td style="text-align: left;">自定义8个32位常量（如0x7380166F等）</td>
<td style="text-align: left;">基于平方根和对数的小数部分取整（如0x6A09E667等）</td>
</tr>
<tr>
<td style="text-align: left;">应用场景</td>
<td style="text-align: left;">我国金融、政务、军工等关键领域强制合规，配合SM2/SM4使用</td>
<td style="text-align: left;">国际通用场景（如TLS、区块链、软件签名等）</td>
</tr>
<tr>
<td style="text-align: left;">实现效率</td>
<td style="text-align: left;">软件实现效率略低于SHA-256，硬件实现适配性强</td>
<td style="text-align: left;">通用CPU上软件实现效率较高，优化成熟</td>
</tr>
</tbody>
</table>
<h2 id="_23">公钥密码<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h2>
<h3 id="rsa">RSA<a class="headerlink" href="#rsa" title="Permanent link">&para;</a></h3>
<h4 id="_24">公钥与私钥<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>随意选择两个大素数 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span>, $ p\ne q$, 计算 <span class="arithmatex">\(N=pq\)</span>.</p>
</li>
<li>
<p>根据欧拉函数，求得 <span class="arithmatex">\(r=\phi(N)=\phi(p) \times \phi(q)=(p-1)(q-1)\)</span></p>
</li>
<li>
<p>选择<span class="arithmatex">\(e&lt;r\)</span> (<span class="arithmatex">\(gcd(e,r)=1\)</span>). 求得<span class="arithmatex">\(d, ed=1 \bmod r\)</span></p>
</li>
<li>
<p>销毁<span class="arithmatex">\(p,q\)</span></p>
</li>
<li>
<p><span class="arithmatex">\(pk=(N,e)\)</span></p>
</li>
</ol>
<p><span class="arithmatex">\(sk=(N,d)\)</span></p>
<h4 id="_25">加密<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<p>将消息 <span class="arithmatex">\(m\)</span> 转换为小于 <span class="arithmatex">\(N\)</span> 的非负整数 <span class="arithmatex">\(n\)</span>：</p>
<p><span class="arithmatex">\(c=n^e\bmod N\)</span></p>
<h4 id="_26">解密<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<p><span class="arithmatex">\(n=c^d\bmod N\)</span></p>
<h6 id="_27">原理<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h6>
<p><span class="arithmatex">\(c^d=n^{ed}\bmod N\)</span></p>
<p>已知 <span class="arithmatex">\(ed=1 \bmod r\)</span>，即 <span class="arithmatex">\(ed=1+h\phi(N)\)</span>，那么有</p>
<p><span class="arithmatex">\(n^{ed}=n^{1+h\phi(N)}=n\cdot (n^{\phi(N)})^h\)</span></p>
<p>若 <span class="arithmatex">\(n\)</span> 与 <span class="arithmatex">\(N\)</span> 互素，则由欧拉定理得：</p>
<p><span class="arithmatex">\(n^{ed}=n\cdot (n^{\phi(N)})^h=n(1)^h=n\bmod N\)</span></p>
<p>若 <span class="arithmatex">\(n\)</span> 与 <span class="arithmatex">\(N\)</span> 不互素，则不失一般性考虑 <span class="arithmatex">\(n=pt\)</span>, 以及 <span class="arithmatex">\(ed-1=k(q-1)\)</span>，得：</p>
<p><span class="arithmatex">\(n^{ed}=(pt)^{ed}=0=pt=n\bmod p\)</span></p>
<p><span class="arithmatex">\(n^{ed}=n^{ed-1}n=n^{k(q-1)}n=(n^{q-1})^kn=1^kn=n\bmod q\)</span></p>
<p>故 <span class="arithmatex">\(n^{ed}=n \bmod N\)</span> 得证</p>
<h4 id="ind-cparsa">IND-CPA安全结构：使用RSA加密<a class="headerlink" href="#ind-cparsa" title="Permanent link">&para;</a></h4>
<p><img src="../../img/Encryption using RSA.png" alt="Encryption using RSA" style="zoom:67%;" /></p>
<p><span class="arithmatex">\(c=m \oplus H(r)\space||\space RSA.ENC_{sk}(r)\)</span></p>
<h4 id="rsa_1">可以直接使用 RSA 实现单向安全吗<a class="headerlink" href="#rsa_1" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>不。带有小消息和小 <span class="arithmatex">\(e\)</span> 的 RSA 函数不安全：</p>
</li>
<li>
<p>假设 <span class="arithmatex">\(p, q &gt; 10^6\)</span>. 因此<span class="arithmatex">\(N = pq &gt; 10^{12}\)</span></p>
</li>
<li>假设 <span class="arithmatex">\(e = 7\)</span> 和消息 <span class="arithmatex">\(m = 5\)</span></li>
<li>
<p>计算 <span class="arithmatex">\(c = m^e \bmod N = 5^7 \bmod N = 78125\bmod N = 78125\)</span></p>
</li>
<li>
<p>密文很小，所以 <span class="arithmatex">\(mod N\)</span> 没有效果。<span class="arithmatex">\(c = m^e\)</span></p>
</li>
<li>
<p><span class="arithmatex">\(\log_{10}c= e\log_{10}\implies m=10^{\frac{\log C}{e}}\)</span></p>
</li>
<li>
<p>在我们的例子中 <span class="arithmatex">\(log 78125 = 4.892\)</span>。因此 <span class="arithmatex">\(\frac{log c}{e} = 0:698\)</span></p>
</li>
<li>
<p>恢复 <span class="arithmatex">\(m=10^{0.698} = 5\)</span></p>
</li>
</ul>
<h4 id="pkcs-1v15">填充:PKCS ##1v1:5<a class="headerlink" href="#pkcs-1v15" title="Permanent link">&para;</a></h4>
<ul>
<li>随机填充</li>
</ul>
<p>​   <span class="arithmatex">\(y = 0x00||0x02||r||0x00||m\)</span></p>
<p>​   <span class="arithmatex">\(c = y^e\bmod N\)</span></p>
<ul>
<li>SSL的解密后处理（1998年前）</li>
</ul>
<p><span class="arithmatex">\(y = c^d mod N\)</span>
  检查 <span class="arithmatex">\(y\)</span> 的前两个字节。如果 $y \ne 0x00||0x02||... $ 输出 <strong>Bad Format</strong> ，否则输出 <span class="arithmatex">\(m\)</span></p>
<h6 id="bleichenbacher">选择密文攻击：Bleichenbacher 攻击<a class="headerlink" href="#bleichenbacher" title="Permanent link">&para;</a></h6>
<ul>
<li>得到一个密文 <span class="arithmatex">\(c = y^e mod N\)</span>。</li>
<li>
<p>计算 <span class="arithmatex">\(c' = c\cdot s^e\bmod N = (y\cdot s)^e\bmod N\)</span>，取合适的 <span class="arithmatex">\(s\)</span>。</p>
</li>
<li>
<p>检查服务器是否接受 <span class="arithmatex">\(c'\)</span>。</p>
</li>
<li>
<p><span class="arithmatex">\(N\)</span> 是一个 <span class="arithmatex">\(k\)</span> 字节数</p>
</li>
<li>
<p><span class="arithmatex">\(2.2^{8(k−2)}\leq ys \bmod N &lt; 3.2^{8(k−2)}\)</span> 和</p>
</li>
<li>
<p><span class="arithmatex">\(2.2^{8(k−2)}\leq y \bmod N &lt; 3.2^{8(k−2)}\)</span></p>
</li>
<li>
<p><span class="arithmatex">\(y \bmod N &lt; 3.2^{8(k−2)}/s\)</span></p>
</li>
<li>
<p>以 <span class="arithmatex">\(s' &gt; s\)</span> 重复上述过程。</p>
</li>
<li>
<p>通过二分查找选择 <span class="arithmatex">\(s\)</span>。</p>
</li>
</ul>
<h4 id="ind-ccaoaep">IND-CCA安全结构：最优非对称加密（OAEP）<a class="headerlink" href="#ind-ccaoaep" title="Permanent link">&para;</a></h4>
<p><img src="../../img/OAEP.png" alt="OAEP" style="zoom: 50%;" /></p>
<p><span class="arithmatex">\(s=(m||0...0)\oplus G(r)\)</span></p>
<p><span class="arithmatex">\(t=r\oplus H(s)\)</span></p>
<p><span class="arithmatex">\(c=RSA.ENC_{pk}(s||t)\)</span></p>
<h3 id="elgamal">ElGamal<a class="headerlink" href="#elgamal" title="Permanent link">&para;</a></h3>
<h3 id="rabin">Rabin<a class="headerlink" href="#rabin" title="Permanent link">&para;</a></h3>
<h3 id="ecc">ECC<a class="headerlink" href="#ecc" title="Permanent link">&para;</a></h3>
<h3 id="sm2">SM2<a class="headerlink" href="#sm2" title="Permanent link">&para;</a></h3>
<p>SM2是我国自主设计的椭圆曲线公钥密码算法，于2010年正式成为国家密码标准（GB/T 32918-2016），可全面替代RSA算法，在安全性、性能和资源占用上均有显著优势，广泛应用于数字签名、密钥交换和数据加密等场景。</p>
<h4 id="_28">算法核心定义<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<p>SM2算法的基础是椭圆曲线密码学（ECC），其核心是在特定有限域上的椭圆曲线群中进行运算，具体定义包含以下关键要素：</p>
<ol>
<li><strong>有限域选择</strong>：采用素数域<span class="arithmatex">\(\mathbb{F}_P\)</span>，其中<span class="arithmatex">\(p\)</span>是一个满足特定安全要求的大素数，标准中规定<span class="arithmatex">\(p\)</span>的比特长度可为256位、384位等，256位是目前最常用的安全级别。</li>
<li><strong>椭圆曲线方程</strong>：在<span class="arithmatex">\(\mathbb{F}_p\)</span>上定义的椭圆曲线方程为<span class="arithmatex">\(y^2 = x^3 + ax + b \pmod{p}\)</span>，其中<span class="arithmatex">\(a\)</span>和<span class="arithmatex">\(b\)</span>是满足<span class="arithmatex">\(4a^3 + 27b^2 \not\equiv 0 \pmod{p}\)</span>的域元素，以确保曲线无奇异点。</li>
<li><strong>基点与阶</strong>：存在一个特定的基点<span class="arithmatex">\(G=(x_G, y_G)\)</span>，它是椭圆曲线上的一个生成元，其阶为<span class="arithmatex">\(n\)</span>（即<span class="arithmatex">\(nG=O\)</span>，<span class="arithmatex">\(O\)</span>为无穷远点）。<span class="arithmatex">\(n\)</span>必须是一个大素数，且满足<span class="arithmatex">\(n &gt; 2^{191}\)</span>和<span class="arithmatex">\(n \not \mid p^k - 1\)</span>（<span class="arithmatex">\(1 \leq k \leq 20\)</span>），以抵抗离散对数相关攻击。</li>
<li><strong>密钥对生成</strong>：<ol>
<li>私钥：随机选择一个整数<span class="arithmatex">\(d\)</span>，满足<span class="arithmatex">\(1 &lt; d &lt; n - 1\)</span>；</li>
<li>公钥：通过椭圆曲线点乘计算<span class="arithmatex">\(P = dG\)</span>，<span class="arithmatex">\(P\)</span>是椭圆曲线上的一个点，与私钥<span class="arithmatex">\(d\)</span>一一对应。</li>
</ol>
</li>
</ol>
<h4 id="_29">核心运算流程<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<p>SM2算法的三大核心应用场景（数字签名、密钥交换、数据加密）对应不同的运算流程，具体如下：</p>
<h5 id="_30">数字签名与验证<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h5>
<p>用于确认数据完整性和发送者身份，是SM2最常用的功能，流程分为“签名生成”和“签名验证”两步。</p>
<h6 id="_31">签名生成<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h6>
<ol>
<li>对待签名数据<span class="arithmatex">\(M\)</span>进行哈希处理，使用SM3密码杂凑算法计算摘要<span class="arithmatex">\(e = SM3(M)\)</span>；</li>
<li>随机选择一个整数<span class="arithmatex">\(k\)</span>，满足<span class="arithmatex">\(1 &lt; k &lt; n - 1\)</span>，计算点<span class="arithmatex">\(K = kG = (x_K, y_K)\)</span>；</li>
<li>计算<span class="arithmatex">\(r = (e + x_K) \pmod{n}\)</span>，若<span class="arithmatex">\(r = 0\)</span>或<span class="arithmatex">\(r + k = n\)</span>，则重新选择<span class="arithmatex">\(k\)</span>；</li>
<li>计算<span class="arithmatex">\(s = [(1 + d)^{-1} \cdot (k - r \cdot d)] \pmod{n}\)</span>，若<span class="arithmatex">\(s = 0\)</span>，则重新选择<span class="arithmatex">\(k\)</span>；</li>
<li>最终签名结果为<span class="arithmatex">\((r, s)\)</span>，与数据<span class="arithmatex">\(M\)</span>一同发送给接收方。</li>
</ol>
<h6 id="_32">签名验证<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h6>
<ol>
<li>接收数据<span class="arithmatex">\(M\)</span>和签名<span class="arithmatex">\((r, s)\)</span>，先验证<span class="arithmatex">\(r\)</span>和<span class="arithmatex">\(s\)</span>是否满足<span class="arithmatex">\(1 \leq r, s \leq n - 1\)</span>，不满足则验证失败；</li>
<li>计算摘要<span class="arithmatex">\(e = SM3(M\)</span>)，并计算<span class="arithmatex">\(t = (r + s) \pmod{n}\)</span>，若$t = $0，则验证失败；</li>
<li>计算点<span class="arithmatex">\(K' = sG + t\)</span>，若$K' = $O（无穷远点），则验证失败；</li>
<li>设<span class="arithmatex">\(K' = (x_{K'}, y_{K'})\)</span>，计算<span class="arithmatex">\(r' = (e + x_{K'}) \pmod{n}\)</span>；</li>
<li>若<span class="arithmatex">\(r' = r\)</span>，则签名验证通过；否则验证失败。</li>
</ol>
<h5 id="_33">密钥交换<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h5>
<p>用于通信双方在不安全信道上协商出一个共享会话密钥，流程需双方交互两次，以A（发起方）和B（响应方）为例：</p>
<ol>
<li><strong>初始化</strong>：A拥有私钥<span class="arithmatex">\(d_A\)</span>和公钥<span class="arithmatex">\(P_A = d_AG <span class="arithmatex">\(；B拥有私钥\)</span>d_B\)</span>和公钥$P_B = d_BG $，双方已互相获取对方公钥。</li>
<li><strong>第一轮交互（A→B）</strong>：<ol>
<li>A随机选整数<span class="arithmatex">\(k_A\)</span>（<span class="arithmatex">\(1 &lt; k_A &lt; n - 1\)</span>），计算<span class="arithmatex">\(K_A = k_AG <span class="arithmatex">\(，并将\)</span>K_A\)</span>发送给B；</li>
</ol>
</li>
<li><strong>第二轮交互（B→A）</strong>：<ol>
<li>B随机选整数<span class="arithmatex">\(k_B\)</span>（$1 &lt; k_B &lt; n - 1 <span class="arithmatex">\(），计算\)</span>K_B = k_BG $；</li>
<li>B计算共享密钥材料<span class="arithmatex">\(S_B = d_B \cdot (K_A + [h]P_A)\)</span>，其中<span class="arithmatex">\(h\)</span>是椭圆曲线的余因子（标准中<span class="arithmatex">\(h=1\)</span>）；</li>
<li>B将<span class="arithmatex">\(K_B\)</span>发送给A，并对<span class="arithmatex">\(K_A\)</span>、<span class="arithmatex">\(K_B\)</span>等信息生成验证数据；</li>
</ol>
</li>
<li><strong>A计算共享密钥</strong>：<ol>
<li>A验证B发送的验证数据，确认B身份；</li>
<li>A计算共享密钥材料<span class="arithmatex">\(S_A = d_A \cdot (K_B + [h]P_B)\)</span>；</li>
</ol>
</li>
<li><strong>密钥派生</strong>：A和B分别对<span class="arithmatex">\(S_A\)</span>、<span class="arithmatex">\(S_B\)</span>进行相同的密钥派生函数（KDF）处理，得到相同的会话密钥<span class="arithmatex">\(SK\)</span>，用于后续数据加密。</li>
</ol>
<h5 id="_34">数据加密与解密<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h5>
<p>用于对敏感数据进行加密，确保仅指定接收方能解密，流程如下：</p>
<h6 id="_35">加密<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h6>
<ol>
<li>获取接收方公钥<span class="arithmatex">\(P\)</span>，验证<span class="arithmatex">\(P\)</span>是否为椭圆曲线上的有效点且<span class="arithmatex">\(nP = O\)</span>，无效则终止；</li>
<li>随机选整数<span class="arithmatex">\(k\)</span>（<span class="arithmatex">\(1 &lt; k &lt; n - <span class="arithmatex">\(），计算\)</span>C_1 = k\)</span>G（作为解密所需的“临时公钥”）；</li>
<li>计算点<span class="arithmatex">\(S = k\)</span>，若<span class="arithmatex">\(S = O\)</span>，则重新选择<span class="arithmatex">\(k\)</span>；设<span class="arithmatex">\(S = (x_S, y_S\)</span>，将<span class="arithmatex">\(x_s\)</span>和<span class="arithmatex">\(y_y\)</span>拼接为字节串<span class="arithmatex">\(xSyS\)</span>；</li>
<li>对明文<span class="arithmatex">\(M\)</span>进行分组（若需），使用对称密码算法（如SM4），以<span class="arithmatex">\(KDF(xSyS, len)\)</span>生成的密钥加密<span class="arithmatex">\(M\)</span>，得到密文<span class="arithmatex">\(C_2\)</span>；</li>
<li>计算<span class="arithmatex">\(C_3 = SM3(xSyS || M)\)</span>（用于验证明文完整性）；</li>
<li>最终密文为<span class="arithmatex">\(C = C_1 || C_2 || C_3\)</span>，发送给接收方。</li>
</ol>
<h6 id="_36">解密<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h6>
<ol>
<li>接收密文<span class="arithmatex">\(c\)</span>，拆分出<span class="arithmatex">\(C_1\)</span>、<span class="arithmatex">\(C_2\)</span>、<span class="arithmatex">\(C_3\)</span>，验证<span class="arithmatex">\(C_1\)</span>是否为椭圆曲线上的有效点，无效则解密失败；</li>
<li>用私钥<span class="arithmatex">\(d\)</span>计算点<span class="arithmatex">\(S = dC_1\)</span>，若<span class="arithmatex">\(S = O\)</span>，则解密失败；设<span class="arithmatex">\(S = (x_S, y_S)\)</span>，拼接为<span class="arithmatex">\(xSyS\)</span>；</li>
<li>生成对称密钥<span class="arithmatex">\(K = KDF(xSyS, len)\)</span>，解密<span class="arithmatex">\(C_2\)</span>得到明文<span class="arithmatex">\(M\)</span>；</li>
<li>计算<span class="arithmatex">\(C_3' = SM3(xSyS || M')\)</span>，若<span class="arithmatex">\(C_3' = C_3\)</span>，则明文有效，<span class="arithmatex">\(M'\)</span>为原始明文；否则解密失败。</li>
</ol>
<h2 id="_37">数字签名<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h2>
<h3 id="rsa_2">RSA<a class="headerlink" href="#rsa_2" title="Permanent link">&para;</a></h3>
<h3 id="elgamal_1">Elgamal<a class="headerlink" href="#elgamal_1" title="Permanent link">&para;</a></h3>
<h3 id="dsa">DSA<a class="headerlink" href="#dsa" title="Permanent link">&para;</a></h3>
<h2 id="_38">密码协议<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h2>
<h3 id="_39">密钥分配<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<h3 id="_40">密钥协商<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<h3 id="_41"><a class="headerlink" href="#_41" title="Permanent link">&para;</a></h3>
<h3 id="_42">秘密共享<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<h3 id="_43">身份识别<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h3>
<h3 id="_44">零知识证明<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h3>
<h2 id="_45">密码学工具<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h2>
<h3 id="openssl">openssl<a class="headerlink" href="#openssl" title="Permanent link">&para;</a></h3>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>