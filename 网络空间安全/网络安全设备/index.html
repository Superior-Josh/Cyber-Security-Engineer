
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="网络安全工程师的学习笔记">
      
      
        <meta name="author" content="Josh">
      
      
        <link rel="canonical" href="https://Superior-Josh.github.io/Cyber-Security-Engineer/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87/">
      
      
        <link rel="prev" href="../%E6%BC%8F%E6%B4%9E/">
      
      
        <link rel="next" href="../%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>网络安全设备 - 网络安全工程师的学习笔记</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#waf" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="网络安全工程师的学习笔记" class="md-header__button md-logo" aria-label="网络安全工程师的学习笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            网络安全工程师的学习笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              网络安全设备
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="teal"  aria-label="切换到深色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到深色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="切换到浅色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到浅色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/" class="md-tabs__link">
          
  
  
  编程语言

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/Linux/" class="md-tabs__link">
          
  
  
  计算机基础

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../AI%20%E5%AE%89%E5%85%A8/" class="md-tabs__link">
          
  
  
  网络空间安全

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E6%B5%8B%E8%AF%95/Black-box%20Testing/" class="md-tabs__link">
          
  
  
  测试

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="网络安全工程师的学习笔记" class="md-nav__button md-logo" aria-label="网络安全工程师的学习笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    网络安全工程师的学习笔记
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    编程语言
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            编程语言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    计算机基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            计算机基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/Linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据结构与算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络协议
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算机操作系统
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    网络空间安全
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            网络空间安全
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI%20%E5%AE%89%E5%85%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI 安全
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ISO%2027001/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ISO 27001
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Metasploit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metasploit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SELinux%E4%B8%8EAppArmor%E8%AF%A6%E8%A7%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SELinux与AppArmor详解
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SonarQube/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SonarQube
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SQLmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQLmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%AF%86%E7%A0%81%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    密码学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%AD%98%E5%82%A8%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    敏感数据安全存储核心技术
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%BC%8F%E6%B4%9E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    漏洞
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    网络安全设备
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    网络安全设备
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#waf" class="md-nav__link">
    <span class="md-ellipsis">
      WAF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WAF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#waf_1" class="md-nav__link">
    <span class="md-ellipsis">
      一、WAF基础认知
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、WAF基础认知">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 定义与核心定位
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 与传统防火墙的区别
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 核心功能与防护范围
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.3 核心功能与防护范围">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.1 核心防护功能
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.2 防护范围延伸
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 典型攻击防护手段详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.4 典型攻击防护手段详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#141-sql" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.1 SQL注入攻击防护
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#142-xss" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.2 跨站脚本（XSS）攻击防护
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#143-csrf" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.3 跨站请求伪造（CSRF）攻击防护
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#144-cc" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.4 CC攻击防护
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#145" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.5 目录遍历攻击防护
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#146" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.6 文件上传漏洞防护
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#147-bot" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.7 Bot爬虫攻击防护
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waf_2" class="md-nav__link">
    <span class="md-ellipsis">
      二、WAF核心技术解析
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、WAF核心技术解析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 核心检测技术
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 关键技术架构
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waf_3" class="md-nav__link">
    <span class="md-ellipsis">
      三、WAF部署方案
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、WAF部署方案">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 部署模式选型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 部署前置准备
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#421" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1 环境调研
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2 软硬件准备
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 详细部署步骤
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.3 详细部署步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-wafwaf" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.1 云WAF部署（以阿里云WAF为例）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#332-wafmodsecuritynginx" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.2 本地WAF部署（以ModSecurity+Nginx为例）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#333-waf" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.3 高可用部署（本地WAF集群）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waf_4" class="md-nav__link">
    <span class="md-ellipsis">
      四、WAF运维与监控
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、WAF运维与监控">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 日常运维操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 日常运维操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1 规则管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.2 日志管理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 监控指标与告警配置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 监控指标与告警配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421_1" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1 核心监控指标
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422_1" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2 告警配置
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 常见故障排查
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waf_5" class="md-nav__link">
    <span class="md-ellipsis">
      五、WAF选型建议
    </span>
  </a>
  
    <nav class="md-nav" aria-label="五、WAF选型建议">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 选型核心维度
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 主流产品推荐
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      六、总结与注意事项
    </span>
  </a>
  
    <nav class="md-nav" aria-label="六、总结与注意事项">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 核心总结
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 注意事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#idsips" class="md-nav__link">
    <span class="md-ellipsis">
      IDS/IPS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IDS/IPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      一、技术定位：网络安全的“监测与防御哨兵”
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ids" class="md-nav__link">
    <span class="md-ellipsis">
      二、IDS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、IDS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 核心原理与技术架构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 核心类型划分
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 优势与适用场景
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ips" class="md-nav__link">
    <span class="md-ellipsis">
      三、IPS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、IPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 核心原理与技术架构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. 核心类型划分
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      3. 优势与适用场景
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idsips_1" class="md-nav__link">
    <span class="md-ellipsis">
      四、IDS与IPS核心区别对比
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      五、部署与协同应用建议
    </span>
  </a>
  
    <nav class="md-nav" aria-label="五、部署与协同应用建议">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    <span class="md-ellipsis">
      1. 单一设备部署场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-idsips" class="md-nav__link">
    <span class="md-ellipsis">
      2. IDS与IPS协同部署
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    <span class="md-ellipsis">
      3. 关键部署注意事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hids" class="md-nav__link">
    <span class="md-ellipsis">
      HIDS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edr" class="md-nav__link">
    <span class="md-ellipsis">
      EDR
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络攻防
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%BD%91%E7%BB%9C%E9%9A%94%E7%A6%BB%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%EF%BC%9AVLAN%E3%80%81%E7%BD%91%E7%BB%9C%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E4%B8%8E%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络隔离核心技术解析：VLAN、网络命名空间与容器网络
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9E%8B%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    访问控制模型对比与选型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E9%98%B2%E7%81%AB%E5%A2%99%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%EF%BC%9Aiptables%E4%B8%8Enftables%E8%A7%84%E5%88%99%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    防火墙核心技术：iptables与nftables规则配置详解
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    测试
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            测试
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%B5%8B%E8%AF%95/Black-box%20Testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Black-box Testing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>网络安全设备</h1>

<h2 id="waf">WAF<a class="headerlink" href="#waf" title="Permanent link">&para;</a></h2>
<h3 id="waf_1">一、WAF基础认知<a class="headerlink" href="#waf_1" title="Permanent link">&para;</a></h3>
<h4 id="11">1.1 定义与核心定位<a class="headerlink" href="#11" title="Permanent link">&para;</a></h4>
<p>Web应用防火墙（WAF）是部署于Web应用程序与客户端之间的专用安全防护设备或软件，通过对HTTP/HTTPS协议流量的深度解析、监控与过滤，识别并阻断针对Web应用的恶意攻击，保障应用程序安全、数据机密性及业务连续性。其核心定位是填补传统网络防火墙在应用层防护的空白，聚焦Web应用特有的安全风险。</p>
<h4 id="12">1.2 与传统防火墙的区别<a class="headerlink" href="#12" title="Permanent link">&para;</a></h4>
<p>传统防火墙与WAF在防护层面、检测能力及防护目标上存在显著差异，具体对比如下：</p>
<table>
<thead>
<tr>
<th>对比维度</th>
<th>传统防火墙</th>
<th>WAF</th>
</tr>
</thead>
<tbody>
<tr>
<td>防护层面</td>
<td>网络层（L3）、传输层（L4）</td>
<td>应用层（L7），聚焦HTTP/HTTPS协议</td>
</tr>
<tr>
<td>检测对象</td>
<td>IP地址、端口、TCP连接状态等网络特征</td>
<td>URL、请求头、请求体、响应内容等应用数据</td>
</tr>
<tr>
<td>核心能力</td>
<td>流量访问控制、连接状态检测</td>
<td>恶意请求识别、攻击行为阻断、业务逻辑防护</td>
</tr>
<tr>
<td>典型防护场景</td>
<td>端口扫描、非法IP访问、SYN Flood攻击</td>
<td>SQL注入、XSS、CSRF、目录遍历、API滥用</td>
</tr>
</tbody>
</table>
<h4 id="13">1.3 核心功能与防护范围<a class="headerlink" href="#13" title="Permanent link">&para;</a></h4>
<h5 id="131">1.3.1 核心防护功能<a class="headerlink" href="#131" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>应用层攻击防护</strong>：针对SQL注入、跨站脚本（XSS）、跨站请求伪造（CSRF）、目录遍历、命令注入、文件上传漏洞等常见Web攻击，通过特征匹配、语义分析等技术实现精准拦截。</p>
</li>
<li>
<p><strong>恶意流量管控</strong>：通过行为分析引擎识别CC攻击、Bot恶意爬虫、暴力破解等行为，支持基于请求频率、IP集中度等多维度动态防护。</p>
</li>
<li>
<p><strong>业务安全防护</strong>：提供表单数据验证、会话劫持防护、API接口权限管控、敏感信息泄露防护（如手机号、身份证号脱敏）等功能。</p>
</li>
<li>
<p><strong>流量可视化与审计</strong>：实时监控Web流量，记录攻击日志、访问日志，支持攻击溯源分析及合规审计报表生成。</p>
</li>
<li>
<p><strong>威胁情报联动</strong>：集成全球恶意IP库、域名库，实时更新威胁情报，提前拦截已知恶意节点攻击。</p>
</li>
</ul>
<h5 id="132">1.3.2 防护范围延伸<a class="headerlink" href="#132" title="Permanent link">&para;</a></h5>
<p>除核心应用层防护外，主流WAF还具备网络层辅助防护能力，可抵御HTTP/HTTPS Flood（CC攻击）、SYN Flood等混合攻击；部分高端产品支持AI大模型应用防护、国产化软硬件适配（如适配飞腾CPU、麒麟操作系统）及多云环境协同防护。</p>
<h4 id="14">1.4 典型攻击防护手段详解<a class="headerlink" href="#14" title="Permanent link">&para;</a></h4>
<p>WAF针对不同类型的Web攻击，采用差异化的防护策略组合，以下为常见攻击类型的具体防护手段拆解：</p>
<h5 id="141-sql">1.4.1 SQL注入攻击防护<a class="headerlink" href="#141-sql" title="Permanent link">&para;</a></h5>
<p>SQL注入攻击是通过在请求参数中插入恶意SQL语句，利用应用程序未对输入进行严格过滤的漏洞，实现对数据库的未授权访问、数据篡改或删除。WAF的防护手段主要包括：</p>
<ul>
<li>
<p><strong>特征签名匹配</strong>：内置SQL注入特征库，对请求中的特殊字符（如单引号、双引号、OR、AND、SELECT、UNION等）及组合模式进行匹配，拦截已知注入语句。</p>
</li>
<li>
<p><strong>参数化查询强制校验</strong>：检测应用程序是否采用参数化查询方式，对直接拼接参数的请求进行预警或拦截，从根源阻断注入风险。</p>
</li>
<li>
<p><strong>语义分析与语法解析</strong>：通过语法分析引擎还原请求中的SQL语句结构，识别“正常业务参数”与“恶意注入代码”的差异，即使攻击者对注入语句进行变形（如大小写混淆、编码转换）也能精准识别。</p>
</li>
<li>
<p><strong>数据库行为基线校验</strong>：建立正常业务场景下的数据库访问行为基线（如访问的表名、字段名、操作类型），当请求触发异常数据库操作（如访问敏感表、执行DROP语句）时立即拦截。</p>
</li>
</ul>
<h5 id="142-xss">1.4.2 跨站脚本（XSS）攻击防护<a class="headerlink" href="#142-xss" title="Permanent link">&para;</a></h5>
<p>XSS攻击是通过注入恶意脚本（如JavaScript、VBScript）到Web页面中，当用户访问页面时脚本执行，实现会话劫持、敏感信息窃取或恶意操作。WAF的防护手段包括：</p>
<ul>
<li>
<p><strong>输入过滤与输出编码</strong>：对请求中的脚本标签（如<script>、<img>）、事件属性（如onclick、onload）及特殊编码（如Base64编码的脚本）进行过滤；同时强制对输出到页面的用户输入内容进行HTML编码（如将&lt;转换为&lt;），使脚本无法执行。</p>
</li>
<li>
<p><strong>同源策略强化</strong>：检测并拦截跨域脚本请求，校验请求头中的Origin、Referer字段，确保脚本来源合法。</p>
</li>
<li>
<p><strong>CSP（内容安全策略）注入</strong>：自动为Web页面注入CSP响应头，限制页面加载脚本的来源、禁止内联脚本执行等，从浏览器层面构建防护屏障。</p>
</li>
<li>
<p><strong>DOM型XSS防护</strong>：针对通过修改页面DOM结构触发的XSS攻击，WAF通过监控页面DOM操作行为，识别恶意脚本对DOM的篡改动作并阻断。</p>
</li>
</ul>
<h5 id="143-csrf">1.4.3 跨站请求伪造（CSRF）攻击防护<a class="headerlink" href="#143-csrf" title="Permanent link">&para;</a></h5>
<p>CSRF攻击是利用用户已认证的会话权限，诱导用户点击恶意链接或访问恶意页面，发起非预期的业务请求（如转账、修改密码）。WAF的防护手段主要有：</p>
<ul>
<li>
<p><strong>Token验证机制</strong>：强制要求所有关键业务请求（如支付、修改信息）携带随机生成的CSRF Token，WAF校验请求中的Token与用户会话中的Token一致性，不一致则拦截。</p>
</li>
<li>
<p><strong>Referer/Origin校验</strong>：校验请求的Referer（来源页面）或Origin（来源域名）是否为可信域名，拦截来自未知域名的请求。</p>
</li>
<li>
<p><strong>会话行为分析</strong>：通过行为分析引擎识别异常请求模式，如同一会话在短时间内从不同IP发起关键操作、请求间隔不符合人类操作习惯等，触发二次验证（如验证码）或拦截。</p>
</li>
</ul>
<h5 id="144-cc">1.4.4 CC攻击防护<a class="headerlink" href="#144-cc" title="Permanent link">&para;</a></h5>
<p>CC攻击通过控制大量肉鸡或模拟正常用户发起高频请求，耗尽Web服务器或应用程序的资源，导致服务不可用。WAF的防护手段包括：</p>
<ul>
<li>
<p><strong>请求频率限制</strong>：基于IP、Cookie、用户账号等维度设置请求频率阈值（如单IP每分钟最多100次请求），超过阈值则临时封禁或限制访问速度。</p>
</li>
<li>
<p><strong>智能人机识别</strong>：通过验证码（如滑动验证码、图文验证码）、JS挑战、设备指纹识别等技术，区分正常用户与恶意Bot，仅对可疑请求发起验证。</p>
</li>
<li>
<p><strong>动态流量调度</strong>：针对大流量CC攻击，云WAF可将流量分散至多个节点进行清洗，本地WAF可结合负载均衡设备实现流量分担，避免单点过载。</p>
</li>
<li>
<p><strong>业务场景适配</strong>：针对登录、注册等高频被攻击接口，单独设置更严格的防护策略，如登录失败N次后锁定IP、限制单IP注册账号数量。</p>
</li>
</ul>
<h5 id="145">1.4.5 目录遍历攻击防护<a class="headerlink" href="#145" title="Permanent link">&para;</a></h5>
<p>目录遍历攻击通过在URL中插入特殊路径字符（如../、../../），利用应用程序对路径解析的漏洞，访问服务器上的敏感文件（如/etc/passwd、配置文件）。WAF的防护手段包括：</p>
<ul>
<li>
<p><strong>路径规范化校验</strong>：将请求中的URL路径转换为标准绝对路径，识别并拦截包含../、./等遍历字符的请求。</p>
</li>
<li>
<p><strong>白名单访问控制</strong>：配置允许访问的目录和文件白名单，仅放行符合白名单的请求，拒绝访问未授权路径。</p>
</li>
<li>
<p><strong>敏感文件拦截</strong>：内置敏感文件库（如系统配置文件、日志文件、数据库备份文件），对请求中包含敏感文件名的访问直接拦截。</p>
</li>
</ul>
<h5 id="146">1.4.6 文件上传漏洞防护<a class="headerlink" href="#146" title="Permanent link">&para;</a></h5>
<p>文件上传漏洞是攻击者通过上传恶意文件（如木马、后门程序）到服务器，进而获取服务器控制权。WAF的防护手段主要有：</p>
<ul>
<li>
<p><strong>文件类型多重校验</strong>：同时校验文件的后缀名、MIME类型、文件头特征（如JPG文件头为FFD8FF），避免攻击者通过修改后缀名绕过防护。</p>
</li>
<li>
<p><strong>文件内容扫描</strong>：对上传文件进行恶意代码扫描，检测文件中是否包含木马、病毒或后门程序，支持对压缩文件的解压扫描。</p>
</li>
<li>
<p><strong>上传路径隔离与权限控制</strong>：强制将上传文件存储到非Web访问目录，或限制上传目录的执行权限（如禁止PHP文件执行），即使上传恶意文件也无法运行。</p>
</li>
<li>
<p><strong>文件名随机化</strong>：对上传文件的文件名进行随机重命名，避免攻击者通过已知文件名访问上传的恶意文件。</p>
</li>
</ul>
<h5 id="147-bot">1.4.7 Bot爬虫攻击防护<a class="headerlink" href="#147-bot" title="Permanent link">&para;</a></h5>
<p>恶意Bot爬虫通过批量爬取网站内容（如商品信息、用户数据）、抢购商品或发起暴力破解，消耗服务器资源并泄露敏感信息。WAF的防护手段包括：</p>
<ul>
<li>
<p><strong>Bot特征识别</strong>：通过识别爬虫的User-Agent、访问频率、请求头特征（如缺少Cookie、固定Referer）等，区分正常爬虫（如搜索引擎爬虫）与恶意Bot。</p>
</li>
<li>
<p><strong>爬虫协议（robots.txt）校验</strong>：检测爬虫是否遵守网站的robots.txt协议，对违反协议的爬虫进行限制或拦截。</p>
</li>
<li>
<p><strong>动态令牌验证</strong>：对高频访问的页面或接口，动态生成临时令牌并嵌入页面，Bot无法获取令牌则无法发起有效请求。</p>
</li>
<li>
<p><strong>威胁情报联动</strong>：联动云端Bot情报库，实时更新已知恶意Bot的IP、指纹信息，提前拦截恶意爬虫访问。</p>
</li>
</ul>
<h3 id="waf_2">二、WAF核心技术解析<a class="headerlink" href="#waf_2" title="Permanent link">&para;</a></h3>
<h4 id="21">2.1 核心检测技术<a class="headerlink" href="#21" title="Permanent link">&para;</a></h4>
<p>WAF通过多引擎协同工作实现精准检测，核心技术包括以下三类：</p>
<ol>
<li>
<p><strong>签名检测技术</strong>：基于已知攻击模式的特征数据库，对请求内容进行模式匹配，快速识别SQL注入、XSS等常见攻击。该技术优势是检测速度快、准确率高，适用于已知攻击的防御；不足是无法应对0day漏洞等未知威胁。</p>
</li>
<li>
<p><strong>行为分析技术</strong>：通过建立正常业务流量基线，监控请求频率、参数变化、访问路径等维度，识别异常行为。例如，短时间内同一IP多次尝试登录、高频访问敏感接口等行为可被精准识别，有效防御CC攻击、暴力破解等。</p>
</li>
<li>
<p><strong>机器学习与智能分析</strong>：高级WAF通过机器学习引擎构建流量模型，自动区分白、灰、黑三色流量。对于未知威胁，可结合语义分析引擎进行语句拆分与语义拆解，实现0day漏洞攻击的有效防御，同时降低误报率。</p>
</li>
</ol>
<h4 id="22">2.2 关键技术架构<a class="headerlink" href="#22" title="Permanent link">&para;</a></h4>
<p>主流企业级WAF通常采用“五大引擎”协同架构，实现全流程智能防护：</p>
<ul>
<li>
<p><strong>基础特征引擎</strong>：承载签名检测功能，快速匹配已知攻击特征。</p>
</li>
<li>
<p><strong>语义分析引擎</strong>：深度解析请求语义，应对变形攻击及未知漏洞。</p>
</li>
<li>
<p><strong>机器学习引擎</strong>：自主学习业务流量特征，动态优化防护规则。</p>
</li>
<li>
<p><strong>行为分析引擎</strong>：基于多维度行为数据检测异常攻击。</p>
</li>
<li>
<p><strong>威胁情报引擎</strong>：联动云端威胁情报库，实时更新防护策略。</p>
</li>
</ul>
<h3 id="waf_3">三、WAF部署方案<a class="headerlink" href="#waf_3" title="Permanent link">&para;</a></h3>
<h4 id="31">3.1 部署模式选型<a class="headerlink" href="#31" title="Permanent link">&para;</a></h4>
<p>WAF部署模式需结合企业IT架构、业务规模及安全需求选择，主流模式包括以下三种：</p>
<table>
<thead>
<tr>
<th>部署模式</th>
<th>实现方式</th>
<th>优势</th>
<th>适用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td>云WAF</td>
<td>通过DNS解析接管域名，用户请求先经过云端WAF节点检测，再转发至源站服务器</td>
<td>无需本地部署硬件/软件，上线快；支持弹性扩展；自带高可用架构</td>
<td>中小企业、电商网站、SaaS服务提供商；无专业运维团队场景</td>
</tr>
<tr>
<td>本地WAF</td>
<td>以硬件设备或软件插件形式串行部署于Web服务器前端，接管所有进出流量</td>
<td>防护精度高，支持定制化规则；数据本地留存，符合合规要求；低延迟</td>
<td>大型企业、金融机构、政务系统；核心业务需高定制化防护场景</td>
</tr>
<tr>
<td>混合部署</td>
<td>云端WAF抵御大流量攻击（如DDoS），本地WAF负责精细化应用防护</td>
<td>兼顾灵活性与安全性，攻防结合</td>
<td>中大型企业、多业务线场景；既有公网业务又有内网核心业务</td>
</tr>
</tbody>
</table>
<h4 id="32">3.2 部署前置准备<a class="headerlink" href="#32" title="Permanent link">&para;</a></h4>
<h4 id="421">4.2.1 环境调研<a class="headerlink" href="#421" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>业务架构调研</strong>：梳理Web服务器数量、部署位置（本地IDC/公有云/混合云）、服务器操作系统（Windows/Linux）、Web中间件（Nginx/Apache/IIS）及业务端口。</p>
</li>
<li>
<p><strong>流量评估</strong>：统计日均访问量、峰值流量、并发连接数，确保WAF性能匹配（如绿盟WAF支持高并发场景，需根据流量选择对应型号）。</p>
</li>
<li>
<p><strong>安全需求梳理</strong>：明确需防护的攻击类型、是否需要合规审计（如等保2.0）、日志留存时长要求等。</p>
</li>
</ul>
<h4 id="422">4.2.2 软硬件准备<a class="headerlink" href="#422" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>云WAF</strong>：准备域名管理权限、源站服务器IP（确保云WAF节点可访问）、管理员账号信息。</p>
</li>
<li>
<p><strong>本地WAF（硬件）</strong>：准备部署机柜空间、电源（AC 220V）、网络接口（至少2个千兆电口/光口）、管理终端（需与WAF管理口通网）。</p>
</li>
<li>
<p><strong>本地WAF（软件）</strong>：确认服务器硬件配置（建议CPU≥8核、内存≥16G、硬盘≥500G）、操作系统兼容性（如CentOS 7.0+、Windows Server 2016+）。</p>
</li>
</ul>
<h4 id="33">3.3 详细部署步骤<a class="headerlink" href="#33" title="Permanent link">&para;</a></h4>
<h5 id="331-wafwaf">3.3.1 云WAF部署（以阿里云WAF为例）<a class="headerlink" href="#331-wafwaf" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>开通服务</strong>：登录阿里云控制台，进入“Web应用防火墙”服务，根据业务规模选择版本（基础版/企业版），完成支付开通。</p>
</li>
<li>
<p><strong>添加防护域名</strong>：进入“防护配置-网站配置”，点击“添加网站”，输入域名（如www.example.com），选择协议类型（HTTP/HTTPS），填写源站IP及端口（如80/443）。</p>
</li>
<li>
<p><strong>域名解析配置</strong>：根据WAF提供的CNAME地址，登录域名解析平台（如阿里云DNS），修改域名的A记录为WAF的CNAME地址，完成流量接管。</p>
</li>
<li>
<p><strong>证书配置（HTTPS场景）</strong>：在WAF控制台上传域名对应的SSL证书（支持PEM格式），开启HTTPS强制跳转及HTTP/2支持。</p>
</li>
<li>
<p><strong>基础规则配置</strong>：启用“基础防护规则集”“OWASP Top 10防护规则”，根据业务场景调整拦截策略（如对登录接口开启验证码防护）。</p>
</li>
<li>
<p><strong>测试验证</strong>：通过浏览器访问域名，在WAF“日志中心”查看访问记录；使用SQL注入测试语句（如?id=1' or 1=1--）发起测试，确认WAF拦截并生成日志。</p>
</li>
</ol>
<h5 id="332-wafmodsecuritynginx">3.3.2 本地WAF部署（以ModSecurity+Nginx为例）<a class="headerlink" href="#332-wafmodsecuritynginx" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>环境部署</strong>：</p>
</li>
<li>
<p>安装依赖包：<code>yum install -y gcc gcc-c++ make pcre-devel openssl-devel libxml2-devel</code>（CentOS系统）。</p>
</li>
<li>
<p>安装Nginx：下载Nginx源码包，编译时加入ModSecurity模块：<code>./configure --add-module=../modsecurity-nginx --with-http_ssl_module</code>，执行<code>make &amp;&amp; make install</code>。</p>
</li>
<li>
<p><strong>ModSecurity配置</strong>：</p>
</li>
</ol>
<p>复制默认配置文件：<code>cp modsecurity.conf-recommended /usr/local/nginx/conf/modsecurity.conf</code>。</p>
<ol>
<li>
<p>启用防护规则：下载OWASP CRS规则集，解压至<code>/usr/local/nginx/conf/crs</code>，在modsecurity.conf中添加<code>Include crs/owasp-crs.load</code>。</p>
</li>
<li>
<p>调整核心参数：设置<code>SecRuleEngine On</code>（开启拦截模式）、<code>SecAuditLog /var/log/modsecurity/audit.log</code>（日志路径）。</p>
</li>
<li>
<p><strong>Nginx联动配置</strong>：在Nginx虚拟主机配置中添加：</p>
<p><code>location / {
   modsecurity on;
   modsecurity_rules_file /usr/local/nginx/conf/modsecurity.conf;
   proxy_pass http://127.0.0.1:8080; ## 转发至后端Web服务
   }</code></p>
</li>
<li>
<p><strong>服务启动与验证</strong>：启动Nginx服务<code>/usr/local/nginx/sbin/nginx</code>，发起攻击测试，查看audit.log确认拦截记录。</p>
</li>
</ol>
<h5 id="333-waf">3.3.3 高可用部署（本地WAF集群）<a class="headerlink" href="#333-waf" title="Permanent link">&para;</a></h5>
<p>为避免WAF单点故障，大型企业可部署双机热备集群，步骤如下：</p>
<ol>
<li>
<p>部署两台相同配置的WAF设备（主/备节点），配置相同的防护规则。</p>
</li>
<li>
<p>通过VRRP协议配置虚拟IP（VIP），主节点故障时自动切换至备节点，切换时间≤3秒。</p>
</li>
<li>
<p>配置日志同步：主备节点日志实时同步至日志服务器（如ELK集群），确保审计数据完整性。</p>
</li>
</ol>
<h3 id="waf_4">四、WAF运维与监控<a class="headerlink" href="#waf_4" title="Permanent link">&para;</a></h3>
<h4 id="41">4.1 日常运维操作<a class="headerlink" href="#41" title="Permanent link">&para;</a></h4>
<h5 id="411">4.1.1 规则管理<a class="headerlink" href="#411" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>规则更新</strong>：云WAF自动更新规则库，本地WAF需每月手动更新OWASP CRS规则及威胁情报库。</p>
</li>
<li>
<p><strong>误拦截处理</strong>：通过WAF日志定位误拦截请求（如正常业务接口被拦截），添加URL白名单或调整规则阈值。例如，在ModSecurity中添加<code>SecRule REQUEST_URI "@streq /api/normal" "id:1000,phase:1,allow"</code>。</p>
</li>
<li>
<p><strong>定制化规则</strong>：针对业务特有风险（如自定义登录接口），编写专用规则。例如，拦截短时间内多次登录失败的请求。</p>
</li>
</ul>
<h5 id="412">4.1.2 日志管理<a class="headerlink" href="#412" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>日志收集</strong>：配置WAF日志输出至集中日志平台（如Splunk、ELK），日志留存时长满足合规要求（如等保要求≥6个月）。</p>
</li>
<li>
<p><strong>日志分析</strong>：定期分析攻击日志，统计攻击类型、来源IP、目标接口，识别高频攻击源并添加黑名单。</p>
</li>
</ul>
<h4 id="42">4.2 监控指标与告警配置<a class="headerlink" href="#42" title="Permanent link">&para;</a></h4>
<h5 id="421_1">4.2.1 核心监控指标<a class="headerlink" href="#421_1" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>指标类型</th>
<th>关键指标</th>
<th>正常范围</th>
<th>监控工具</th>
</tr>
</thead>
<tbody>
<tr>
<td>性能指标</td>
<td>吞吐量、并发连接数、延迟</td>
<td>延迟≤50ms，并发≥业务峰值1.2倍</td>
<td>Zabbix、Prometheus</td>
</tr>
<tr>
<td>安全指标</td>
<td>攻击拦截数、误拦率、威胁情报匹配数</td>
<td>误拦率≤0.1%</td>
<td>WAF控制台、SIEM平台</td>
</tr>
<tr>
<td>设备状态</td>
<td>CPU使用率、内存使用率、硬盘空间</td>
<td>CPU≤70%，内存≤80%</td>
<td>Zabbix、设备自带监控</td>
</tr>
</tbody>
</table>
<h5 id="422_1">4.2.2 告警配置<a class="headerlink" href="#422_1" title="Permanent link">&para;</a></h5>
<p>配置多级告警机制，确保异常情况及时响应：</p>
<ul>
<li>
<p><strong>一级告警（紧急）</strong>：WAF设备故障、攻击流量超过峰值80%，通过短信+邮件+电话告警，响应时限≤15分钟。</p>
</li>
<li>
<p><strong>二级告警（重要）</strong>：误拦率超过0.5%、新类型攻击出现，通过邮件+企业微信告警，响应时限≤1小时。</p>
</li>
<li>
<p><strong>三级告警（普通）</strong>：规则更新失败、日志存储空间不足，通过邮件告警，响应时限≤24小时。</p>
</li>
</ul>
<h4 id="43">4.3 常见故障排查<a class="headerlink" href="#43" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>故障现象</th>
<th>可能原因</th>
<th>排查步骤</th>
</tr>
</thead>
<tbody>
<tr>
<td>WAF拦截正常业务请求</td>
<td>规则过于严格、业务请求含特殊字符</td>
<td>1. 查看WAF拦截日志，定位触发的规则ID；2. 分析请求内容，确认是否为正常业务数据；3. 调整规则阈值或添加白名单</td>
</tr>
<tr>
<td>WAF无法拦截攻击请求</td>
<td>规则未启用、规则库未更新、攻击为0day漏洞</td>
<td>1. 检查SecRuleEngine状态是否为On；2. 确认规则库版本为最新；3. 收集攻击样本，提交厂商更新规则</td>
</tr>
<tr>
<td>Web服务延迟过高</td>
<td>WAF性能不足、规则过多、网络带宽瓶颈</td>
<td>1. 监控WAF CPU/内存使用率；2. 简化冗余规则；3. 升级WAF硬件或扩容带宽</td>
</tr>
</tbody>
</table>
<h3 id="waf_5">五、WAF选型建议<a class="headerlink" href="#waf_5" title="Permanent link">&para;</a></h3>
<h4 id="51">5.1 选型核心维度<a class="headerlink" href="#51" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>性能匹配</strong>：根据业务峰值流量选择WAF吞吐量（如10Gbps吞吐量对应日均千万级访问量）。</p>
</li>
<li>
<p><strong>防护能力</strong>：优先选择支持机器学习、语义分析的产品，确保对未知威胁的防御能力。</p>
</li>
<li>
<p><strong>合规适配</strong>：金融、政务等行业需选择通过等保2.0认证、支持国产化适配的产品。</p>
</li>
<li>
<p><strong>可扩展性</strong>：支持多云环境、API接口开放（便于与SIEM集成）的产品更适合长期发展。</p>
</li>
<li>
<p><strong>运维成本</strong>：中小企业优先选择云WAF（降低运维成本），大型企业可考虑本地WAF+专业运维团队。</p>
</li>
</ul>
<h4 id="52">5.2 主流产品推荐<a class="headerlink" href="#52" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>云WAF</strong>：阿里云WAF、腾讯云WAF、百度智能云WAF（优势：弹性扩展、运维便捷）。</p>
</li>
<li>
<p><strong>本地WAF</strong>：安恒信息明御WAF、绿盟科技NSFOCUS WAF、启明星辰天擎WAF（优势：高定制化、国产化适配）。</p>
</li>
<li>
<p><strong>开源WAF</strong>：ModSecurity（优势：免费、可定制；不足：需专业技术维护）。</p>
</li>
</ul>
<h3 id="_1">六、总结与注意事项<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<h4 id="61">6.1 核心总结<a class="headerlink" href="#61" title="Permanent link">&para;</a></h4>
<p>WAF作为Web应用安全的核心防护设备，其部署需结合业务架构选择合适的模式（云/本地/混合），通过“规则配置-测试验证-运维监控”的全流程管理实现有效防护。同时，WAF并非万能，需与网络防火墙、入侵检测系统（IDS）、漏洞扫描工具协同工作，构建多层安全防护体系。</p>
<h4 id="62">6.2 注意事项<a class="headerlink" href="#62" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>部署WAF后需定期进行渗透测试，验证防护效果，避免规则配置疏漏。</p>
</li>
<li>
<p>避免过度防护：过多的规则会增加延迟及误拦率，需结合业务场景精简规则。</p>
</li>
<li>
<p>重视日志分析：通过攻击日志挖掘业务潜在风险（如频繁被攻击的接口可能存在代码漏洞）。</p>
</li>
<li>
<p>应急响应预案：制定WAF故障、大规模攻击等场景的应急方案，定期演练。</p>
</li>
</ul>
<h2 id="idsips">IDS/IPS<a class="headerlink" href="#idsips" title="Permanent link">&para;</a></h2>
<p>在网络安全防护体系中，防火墙作为第一道防线可实现基础的访问控制，但无法有效识别和应对针对网络协议漏洞、应用层漏洞的恶意攻击（如SQL注入、勒索病毒传播、端口扫描等）。入侵检测系统（IDS）和入侵防御系统（IPS）作为“深度防御”的核心组件，通过实时监控网络流量、识别攻击行为并采取响应措施，构建起防火墙之外的第二道安全屏障。本文将深入解析IDS与IPS的技术原理、核心特性、类型划分及适用场景，明确两者的核心差异，为安全防护体系搭建提供技术支撑。</p>
<h3 id="_2">一、技术定位：网络安全的“监测与防御哨兵”<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>IDS与IPS同属入侵检测与防御技术体系，核心目标是识别网络中的恶意攻击行为（如未授权访问、漏洞利用、恶意代码传播等），但两者在“响应方式”上存在本质区别：</p>
<ul>
<li><strong>IDS（Intrusion Detection System，入侵检测系统）</strong>：定位为“网络监测工具”，仅对网络流量进行实时监测、分析和攻击识别，发现异常后通过日志记录、告警通知等方式向管理员反馈，<strong>不直接阻断攻击流量</strong>，属于“被动防御”技术。</li>
<li><strong>IPS（Intrusion Prevention System，入侵防御系统）</strong>：定位为“网络防御工具”，在IDS的“监测识别”基础上增加了“主动阻断”能力，可实时拦截恶意流量、阻断攻击行为，属于“主动防御”技术。</li>
</ul>
<p>两者均需基于“攻击特征库”“行为分析模型”等核心组件实现攻击识别，通常部署在防火墙与核心业务网络之间，或关键服务器集群前端，形成“防火墙过滤→IDS/IPS深度检测→核心网络”的多层防护架构。</p>
<h3 id="ids">二、IDS<a class="headerlink" href="#ids" title="Permanent link">&para;</a></h3>
<h4 id="1">1. 核心原理与技术架构<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<p>IDS的核心工作流程为“流量采集→数据预处理→攻击识别→告警响应”，其技术架构主要包含四大核心模块：</p>
<ol>
<li><strong>流量采集模块</strong>：通过网络接口（如镜像端口、Tap设备）采集网络流量数据（包括TCP/UDP数据包、应用层协议数据等），确保采集的流量覆盖需监测的网络链路，且不影响原始流量的正常传输。</li>
<li><strong>数据预处理模块</strong>：对采集的原始流量进行去重、协议解析、数据格式化等处理，提取关键信息（如源IP、目标IP、端口号、协议类型、数据包 payload 内容等），为后续识别提供标准化数据。</li>
<li><strong>攻击识别模块</strong>：IDS的核心模块，通过“特征匹配”或“行为分析”两种方式识别攻击行为，具体包括： - 特征匹配：基于预设的“攻击特征库”（包含已知攻击的特征码，如SQL注入的“select * from”恶意语句、勒索病毒的传播端口特征等），对比流量数据中的特征，匹配成功则判定为攻击； - 行为分析：基于机器学习或统计模型，建立正常网络行为基线（如正常的端口访问频率、数据传输量范围），当流量行为偏离基线且超过阈值时，判定为异常攻击（如异常的批量端口扫描、突发的大流量数据外发）。</li>
<li><strong>告警响应模块</strong>：当识别到攻击行为后，通过日志记录（详细记录攻击时间、源IP、目标IP、攻击类型等信息）、告警通知（如短信、邮件、运维平台工单）等方式反馈，部分高级IDS支持联动运维平台展示攻击链路，但不直接干预流量传输。</li>
</ol>
<h4 id="2">2. 核心类型划分<a class="headerlink" href="#2" title="Permanent link">&para;</a></h4>
<p>根据部署位置和监测对象的不同，IDS主要分为以下两类：</p>
<ul>
<li><strong>NIDS（Network-based IDS，网络型入侵检测系统）</strong>： - 部署方式：部署在网络关键链路（如核心交换机镜像端口、防火墙出口处），通过Tap设备或端口镜像采集全网流量； - 监测范围：监测整个网络链路中的流量，识别针对网络中所有设备的攻击行为（如针对服务器、终端的攻击）； - 优势：监测范围广，可发现网络层面的攻击（如DDoS攻击、端口扫描）； - 局限性：对加密流量（如HTTPS）无法深度解析，难以识别应用层攻击；高并发场景下可能出现流量丢包，导致漏检。</li>
<li><strong>HIDS（Host-based IDS，主机型入侵检测系统）</strong>： - 部署方式：以代理（Agent）形式安装在需要保护的主机（如服务器、核心终端）上； - 监测范围：监测主机本地的系统行为，包括进程创建、文件修改、注册表变更、本地网络连接等； - 优势：可监测主机本地的异常行为（如恶意进程启动、勒索病毒加密文件），不受加密流量影响；能精准定位被攻击的主机； - 局限性：监测范围仅覆盖单台主机，需在每台目标主机部署Agent，运维成本较高；无法监测网络层面的全局攻击。</li>
</ul>
<h4 id="3">3. 优势与适用场景<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<p><strong>核心优势</strong>：不影响网络正常流量传输，避免误判导致的业务中断；支持对攻击行为的详细日志记录，为安全事件追溯和分析提供可靠依据；HIDS可弥补NIDS对加密流量和主机本地行为监测的不足。</p>
<p><strong>适用场景</strong>：需对攻击行为进行精准追溯的场景（如金融、政务系统的安全审计）；无法容忍主动阻断可能导致业务中断的核心业务网络（如医院的诊疗系统网络）；作为IPS的补充，实现“监测+防御”的双重验证。</p>
<h3 id="ips">三、IPS<a class="headerlink" href="#ips" title="Permanent link">&para;</a></h3>
<h4 id="1_1">1. 核心原理与技术架构<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h4>
<p>IPS的技术架构基于IDS扩展而来，核心工作流程为“流量拦截→监测识别→主动响应→日志反馈”，相比IDS增加了“流量拦截”和“主动响应”模块，实现从“监测”到“防御”的升级：</p>
<ol>
<li><strong>流量拦截模块</strong>：IPS采用“串联部署”方式接入网络链路，所有流量需经过IPS转发才能到达目标设备，因此可直接拦截恶意流量。该模块支持对TCP/UDP连接的实时控制，如中断异常连接、丢弃恶意数据包。</li>
<li><strong>监测识别模块</strong>：与IDS的识别逻辑一致，结合“特征匹配”和“行为分析”识别攻击行为，但IPS的特征库更新更及时，且支持实时加载新特征，以应对新型攻击。</li>
<li><strong>主动响应模块</strong>：IPS的核心模块，当识别到攻击行为后，可执行多种主动防御操作： - 直接阻断：丢弃恶意数据包、中断攻击方与目标的网络连接； - 流量限流：对疑似攻击的流量（如DDoS攻击流量）进行限流，避免占用过多网络带宽； - 地址封禁：临时封禁攻击源IP地址（如封禁频繁发起端口扫描的IP）； - 协议过滤：阻断存在漏洞的协议或端口（如关闭未使用的135、445端口，防范勒索病毒传播）。</li>
<li><strong>日志与联动模块</strong>：记录攻击行为和防御操作日志，同时支持与防火墙、WAF（Web应用防火墙）等设备联动，同步更新防御策略（如IPS识别到某IP发起攻击后，联动防火墙封禁该IP）。</li>
</ol>
<h4 id="2_1">2. 核心类型划分<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h4>
<p>IPS的类型划分与IDS类似，根据部署位置和防护对象可分为以下两类，且在功能上更侧重“防御能力”：</p>
<ul>
<li><strong>NIPS（Network-based IPS，网络型入侵防御系统）</strong>： - 部署方式：串联部署在网络关键链路（如防火墙与核心交换机之间），所有网络流量需经过NIPS转发； - 防护能力：拦截网络层面的攻击（如DDoS攻击、端口扫描、漏洞利用攻击），支持对应用层协议（如HTTP、FTP）的深度解析，识别并阻断SQL注入、XSS等应用层攻击； - 关键特性：支持高并发流量处理，避免转发延迟影响业务；部分高端NIPS支持SSL解密，可对加密流量进行深度检测和防御。</li>
<li><strong>HIPS（Host-based IPS，主机型入侵防御系统）</strong>： - 部署方式：以Agent形式安装在目标主机上，深度集成主机操作系统； - 防护能力：拦截主机本地的恶意行为，如阻止恶意进程启动、禁止未授权的文件修改、拦截主机与恶意IP的连接；支持对主机应用程序的行为管控（如限制数据库服务的异常端口连接）； - 关键特性：与主机系统结合紧密，可实现“进程-文件-网络”的联动防御，防护粒度更细。</li>
</ul>
<h4 id="3_1">3. 优势与适用场景<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h4>
<p><strong>核心优势</strong>：可主动阻断恶意攻击，从源头遏制攻击蔓延；支持与其他安全设备联动，构建协同防护体系；NIPS和HIPS结合可实现“网络-主机”的全维度防御，覆盖网络层和主机层攻击。</p>
<p><strong>适用场景</strong>：需主动防御新型攻击的互联网边界网络（如企业外网入口、电商平台的公网链路）；核心业务服务器集群的前端防护（如数据库服务器、支付系统服务器前端）；需应对勒索病毒、挖矿病毒等主动攻击的终端集群（如企业办公终端、数据中心服务器）。</p>
<h3 id="idsips_1">四、IDS与IPS核心区别对比<a class="headerlink" href="#idsips_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">对比维度</th>
<th style="text-align: left;">IDS（入侵检测系统）</th>
<th style="text-align: left;">IPS（入侵防御系统）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">核心定位</td>
<td style="text-align: left;">被动监测工具，仅识别和告警</td>
<td style="text-align: left;">主动防御工具，识别并阻断攻击</td>
</tr>
<tr>
<td style="text-align: left;">部署方式</td>
<td style="text-align: left;">旁路部署（如端口镜像、Tap设备），不串联链路</td>
<td style="text-align: left;">串联部署，所有流量需经过设备转发</td>
</tr>
<tr>
<td style="text-align: left;">对业务影响</td>
<td style="text-align: left;">不干预流量传输，无业务中断风险</td>
<td style="text-align: left;">若误判可能阻断正常流量，导致业务中断</td>
</tr>
<tr>
<td style="text-align: left;">响应方式</td>
<td style="text-align: left;">日志记录、告警通知、攻击追溯</td>
<td style="text-align: left;">丢弃数据包、中断连接、封禁IP、限流等</td>
</tr>
<tr>
<td style="text-align: left;">性能要求</td>
<td style="text-align: left;">要求流量采集完整，对转发性能无要求</td>
<td style="text-align: left;">需高转发性能和低延迟，避免影响业务</td>
</tr>
<tr>
<td style="text-align: left;">典型应用</td>
<td style="text-align: left;">安全审计、攻击追溯、核心业务监测</td>
<td style="text-align: left;">互联网边界防御、服务器集群防护、主动攻击拦截</td>
</tr>
</tbody>
</table>
<h3 id="_3">五、部署与协同应用建议<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<h4 id="1_2">1. 单一设备部署场景<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>仅部署IDS</strong>：适用于核心业务网络（如金融交易系统、医院诊疗系统），需优先保障业务连续性，不允许主动阻断可能带来的风险；或作为安全审计的核心组件，满足合规要求（如等保2.0的日志审计要求）。</li>
<li><strong>仅部署IPS</strong>：适用于中小规模企业的互联网边界防护，需简单高效的主动防御能力，且业务对误判的容忍度较高（如普通办公网络、非核心电商平台）。</li>
</ul>
<h4 id="2-idsips">2. IDS与IPS协同部署<a class="headerlink" href="#2-idsips" title="Permanent link">&para;</a></h4>
<p>大规模企业或高安全需求场景建议采用“IDS+IPS”协同部署，构建“主动防御+被动监测”的双重防护体系，典型部署架构如下：</p>
<ol>
<li><strong>边界层</strong>：互联网出口→防火墙→NIPS→核心交换机，NIPS串联部署实现主动拦截边界攻击（如DDoS、SQL注入）；</li>
<li><strong>核心层</strong>：核心交换机通过端口镜像将流量转发至NIDS，NIDS监测核心网络流量，验证NIPS的防御效果并记录详细攻击日志；</li>
<li><strong>主机层</strong>：核心服务器（如数据库、支付系统）部署HIPS，防御主机本地攻击；同时部署HIDS，记录主机层面的攻击行为和防御操作，用于安全事件追溯。</li>
</ol>
<h4 id="3_2">3. 关键部署注意事项<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>IPS误判优化</strong>：定期更新IPS特征库，基于业务场景自定义防护规则（如放行核心业务的特定端口通信），避免误判阻断正常业务；</li>
<li><strong>IDS流量覆盖</strong>：确保NIDS的流量采集覆盖所有关键链路，避免出现监测盲区；HIDS需部署在所有核心主机上，实现主机层面的全面监测；</li>
<li><strong>日志联动分析</strong>：将IDS和IPS的日志统一接入SIEM（安全信息和事件管理）平台，通过关联分析识别复杂攻击（如APT攻击的多步骤行为），提升攻击溯源能力。</li>
</ul>
<p>注意：IDS和IPS的防护效果依赖于攻击特征库的实时更新，需定期升级特征库以应对新型攻击；同时，两者均无法防御“零日漏洞”攻击，需结合漏洞扫描、补丁管理等技术，构建全生命周期的安全防护体系。</p>
<h2 id="hids">HIDS<a class="headerlink" href="#hids" title="Permanent link">&para;</a></h2>
<h2 id="edr">EDR<a class="headerlink" href="#edr" title="Permanent link">&para;</a></h2>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>