# 访问控制模型对比与选型

### 自主访问控制（DAC）、强制访问控制（MAC）、基于角色的访问控制（RBAC）详解

在网络安全和系统权限管理中，访问控制是核心技术之一，用于确保只有授权主体（用户、进程、设备等）能访问特定客体（文件、数据库、网络资源等）。以下从 **定义、核心原理、实现机制、典型场景、优缺点** 等维度，详细解析三大经典访问控制模型：DAC、MAC、RBAC。

## 一、自主访问控制（Discretionary Access Control, DAC）

### 1. 定义

DAC 是最基础的访问控制模型，核心特点是 **资源所有者拥有自主决定权**：资源的创建者或所有者可以自主授予/撤销其他主体对该资源的访问权限，且权限可在主体间传递（如 A 授予 B 权限后，B 可能再授予 C）。

### 2. 核心原理

- **主体（Subject）**：发起访问请求的实体（如用户、进程）。  

- **客体（Object）**：被访问的资源（如文件、文件夹、数据库表）。  

- **访问控制列表（ACL）**：每个客体关联一个权限列表，记录哪些主体拥有对该客体的何种权限（如读、写、执行）。  

- **权限传递**：所有者可将权限转授给其他主体，形成“自主扩散”特性。

### 3. 典型实现

- **文件系统**：Unix/Linux 的文件权限（所有者、组、其他用户的 r/w/x 权限）、Windows 的文件共享权限（通过 ACL 配置用户/组权限）。  

- **数据库**：MySQL 的表级权限（`GRANT SELECT/INSERT ON table TO user`），所有者可转授权限（需带 `WITH GRANT OPTION`）。  

### 4. 优点

- 灵活性高：资源所有者可按需分配权限，适配小型团队或个人资源管理场景。  

- 易用性强：配置简单，无需复杂的角色或策略设计，普通用户即可操作。  

### 5. 缺点

- 安全性弱：权限易扩散（如用户误授权、恶意转授），难以控制“权限泄露”。  

- 管理成本高：缺乏集中管控，当用户/资源数量增多时，权限审计和回收困难（如员工离职后未回收权限）。  

- 不支持最小权限原则：易出现“过度授权”（如普通用户获得管理员级别的文件修改权限）。  

### 6. 适用场景

- 个人设备（如电脑文件管理）、小型团队协作（如部门内部共享文档）、对安全性要求较低的场景。

## 二、强制访问控制（Mandatory Access Control, MAC）

### 1. 定义

MAC 是高安全性的访问控制模型，核心特点是 **权限由系统管理员统一配置的“强制策略”决定**，资源所有者无法自主修改权限，主体与客体均被分配固定的“安全标签”，访问是否允许由系统根据标签自动判断，不依赖用户意愿。

### 2. 核心原理

- **安全标签（Security Label）**：  

    - 主体标签：代表主体的安全级别（如“秘密”“机密”“绝密”）或 clearance（授权等级）。  

    - 客体标签：代表客体的敏感级别（如“秘密”“机密”“绝密”）。  

- **强制访问规则**：系统预设严格的访问规则，只有满足规则的请求才被允许，常见规则包括：  

    - **Bell-LaPadula 模型（BLP）**：侧重“机密性”，核心规则是“下读上写”（主体只能读取安全级别低于或等于自身的客体，只能写入安全级别高于或等于自身的客体），防止高敏感信息泄露。  

    - **Biba 模型**：侧重“完整性”，核心规则是“上读下写”（主体只能读取安全级别高于或等于自身的客体，只能写入安全级别低于或等于自身的客体），防止低完整性数据污染高完整性资源。  

- **集中管控**：所有权限策略由系统管理员配置，用户（包括资源所有者）无法修改，确保策略的刚性执行。

### 3. 典型实现

- **操作系统**：美国国防部的 Trusted Solaris、SELinux（Linux 安全增强模块，支持 MAC 模式，通过安全上下文标签控制访问）、AppArmor。  

- **军事/涉密系统**：涉密计算机、军用通信设备（如主体标签为“绝密”的用户才能访问标签为“绝密”的作战计划文件）。  

- **数据库**：Oracle 数据库的 Label Security 组件（通过标签控制用户对敏感数据的访问）。  

### 4. 优点

- 安全性极高：权限强制生效，无自主修改或转授可能，能有效防止权限滥用和信息泄露，满足涉密或高安全等级场景需求。  

- 严格遵循最小权限和安全策略：访问规则由系统自动校验，避免人为误操作。  

- 可审计性强：所有访问请求均由系统记录，便于安全审计和违规追溯。  

### 5. 缺点

- 灵活性极差：策略固定，无法适配动态变化的业务场景（如临时需要给低级别用户授权访问高敏感资源）。  

- 配置复杂：需要管理员深入理解安全模型和业务需求，标签设计和策略配置成本高。  

- 易用性差：普通用户无权限调整权限，可能影响工作效率（如紧急情况下无法快速获取所需资源访问权）。  

### 6. 适用场景

- 军事、政府、金融等涉密或高安全等级场景（如国家机密文件管理、银行核心数据存储）、对数据机密性/完整性要求极高的系统。

## 三、基于角色的访问控制（Role-Based Access Control, RBAC）

### 1. 定义

RBAC 是目前最主流的访问控制模型，核心特点是 **“权限与角色关联，用户与角色关联”**，通过角色作为“中间层”简化权限管理：管理员先定义角色并分配对应权限，再将用户分配到不同角色，用户通过所属角色间接获得权限，无需直接分配权限给用户。

### 2. 核心组件（ANSI INCITS 359 标准定义）

- **用户（User）**：发起访问请求的主体（如员工、系统账号）。  

- **角色（Role）**：基于业务职责定义的权限集合（如“管理员”“普通员工”“审计员”）。  

- **权限（Permission）**：主体对客体的操作许可（如“文件读取”“数据库修改”“系统配置”）。  

- **会话（Session）**：用户登录后与角色的临时关联（支持“最小权限”，如用户可在不同会话中激活不同角色）。  

### 3. 核心原理

1. 管理员根据业务需求，定义角色（如“电商系统-订单审核员”）；  

2. 为每个角色分配对应的权限（如“订单审核员”拥有“查看订单”“审核订单”权限，无“删除订单”权限）；  

3. 将用户分配到对应角色（如员工 A 分配到“订单审核员”角色）；  

4. 用户登录后，通过所属角色获得权限，系统校验角色权限是否匹配访问请求。  

### 4. 扩展模型

- **RBAC0（基础模型）**：包含用户、角色、权限的三元关联（用户-角色-权限），是核心基础。  

- **RBAC1（角色层级）**：支持角色继承（如“超级管理员”继承“普通管理员”的所有权限），简化角色配置。  

- **RBAC2（约束模型）**：添加权限约束（如“互斥角色”：用户不能同时拥有“采购员”和“财务审核员”角色，防止舞弊）、“角色容量”（如“管理员”角色最多分配 5 个用户）。  

- **RBAC3（综合模型）**：整合 RBAC1 和 RBAC2，支持角色层级和约束，适用于复杂企业场景。  

### 5. 典型实现

- **企业级系统**：OA 系统（如钉钉、企业微信的角色权限配置）、ERP 系统（如 SAP 的用户角色管理）。  

- **云平台**：AWS IAM（通过角色关联权限策略，用户/服务通过角色获取权限）、阿里云 RAM（资源访问控制，基于角色分配云资源权限）。  

- **操作系统**：Windows Active Directory（通过“组”实现角色管理，如“Domain Admins”组对应管理员权限）。  

- **网络设备**：华为、Cisco 路由器的 AAA 认证（通过 RADIUS 服务器分配角色权限，如“网络管理员”“监控员”）。  

### 6. 优点

- 简化权限管理：减少用户与权限的直接关联（如 100 个普通员工只需分配到“普通员工”角色，无需逐一配置权限），降低管理成本。  

- 安全性强：支持最小权限原则（角色仅分配必要权限），权限集中管控，便于审计和回收（如员工离职时，只需移除其角色关联即可回收所有权限）。  

- 灵活性高：角色可按需定义和调整，适配业务变化（如新增“数据分析师”角色，直接分配对应权限即可）。  

- 可扩展性好：支持角色层级和约束，适配从小型团队到大型企业的复杂场景。  

### 7. 缺点

- 初始配置成本高：需要梳理业务职责、定义角色和权限矩阵，对管理员的业务理解要求较高。  

- 角色冗余风险：若角色设计不合理（如角色过多、权限重叠），可能导致管理复杂。  

### 8. 适用场景

- 企业级应用、大型团队、云平台、网络设备管理等需要集中管控、权限复杂且频繁变化的场景（目前绝大多数商业系统和企业内部系统均采用 RBAC 模型）。

## 四、三大模型核心对比表

|特性|自主访问控制（DAC）|强制访问控制（MAC）|基于角色的访问控制（RBAC）|
|---|---|---|---|
|权限控制主体|资源所有者（自主决定）|系统管理员（强制策略）|系统管理员（角色关联）|
|核心关联|用户 ↔ 权限|主体标签 ↔ 客体标签（规则匹配）|用户 ↔ 角色 ↔ 权限|
|灵活性|极高（自主分配）|极低（策略固定）|中高（角色可灵活定义）|
|安全性|低（权限易扩散）|极高（强制策略，无自主修改）|中高（集中管控，最小权限）|
|管理成本|低（分散管理）|高（策略复杂，需专业配置）|中（初始配置成本高，后续维护简单）|
|适用场景|个人设备、小型团队、低安全需求|涉密系统、高安全等级场景（军事、金融）|企业级系统、大型团队、复杂权限场景|
|典型实现|Unix/Linux 文件权限、Windows ACL|SELinux、Trusted Solaris、涉密系统|AWS IAM、企业 OA、ERP 系统、AD 组|
## 五、总结与选型建议

1. **选型核心原则**：  

    - 优先考虑 **安全性需求**：高安全场景（涉密、金融核心数据）选 MAC；普通安全需求选 RBAC；低安全需求选 DAC。  

    - 其次考虑 **管理规模**：用户/资源数量多（≥50）选 RBAC；数量少（<10）选 DAC；MAC 仅适用于特定高安全场景。  

    - 最后考虑 **业务灵活性**：业务频繁变化、角色调整频繁选 RBAC；业务固定、无权限调整需求选 MAC；个人/小型协作选 DAC。  

2. **实际应用趋势**：  

    - 目前绝大多数企业级系统、云平台、网络设备均采用 **RBAC 模型**（或其扩展），因其平衡了安全性、灵活性和管理效率。  

    - MAC 仅在涉密、军事等特殊场景使用，普通业务系统极少采用。  

    - DAC 仅用于个人设备或简单共享场景，逐渐被 RBAC 替代（如企业文件共享已从“自主授权”改为“角色授权”）。  

3. **面试高频考点**：  

    - DAC 核心：资源所有者自主授权，ACL 实现，安全性弱。  

    - MAC 核心：安全标签、强制策略（BLP/Biba 模型），高安全性，适用于涉密场景。  

    - RBAC 核心：用户-角色-权限，角色层级/约束，企业级主流模型，优势是简化管理、支持最小权限。  

通过以上解析，可清晰理解三大访问控制模型的核心差异和适用场景，在面试中可结合具体技术实现（如 SELinux、AWS IAM）展开说明，体现技术深度。
> （注：文档部分内容可能由 AI 生成）