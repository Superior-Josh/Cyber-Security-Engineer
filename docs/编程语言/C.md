[Linux C编程一站式学习](https://akaedu.github.io/book/index.html)

## GCC

GCC（GNU Compiler Collection）是Linux下最常用的C/C++编译器，支持从源代码到可执行文件的完整编译流程。

### 1. 编译命令

最基础的编译命令可直接将 `.c` 或 `.cpp` 文件生成可执行文件，默认输出名为 `a.out`。

- 编译C文件：`gcc hello.c`，生成可执行文件 `a.out`。
- 编译C++文件：`g++ hello.cpp`，生成可执行文件 `a.out`。
- 指定输出文件名：`gcc hello.c -o hello`，生成名为 `hello` 的可执行文件，避免覆盖默认的 `a.out`。

### 2. 多文件编译

当程序包含多个源文件（如 `main.c`、`func.c`）时，有两种编译方式：

1. 直接指定所有文件：`gcc main.c func.c -o app`，适合文件数量较少的场景。
2. 分步编译（推荐）：先将每个源文件编译为目标文件（`.o`），再链接成可执行文件，修改单个文件时无需重新编译所有文件。
    1. 编译目标文件：`gcc -c main.c -o main.o`、`gcc -c func.c -o func.o`。
    1. 链接目标文件：`gcc main.o func.o -o app`。

### 3. 常用编译选项

| 选项       | 功能说明                                            | 示例                            |
| ---------- | --------------------------------------------------- | ------------------------------- |
| `-Wall`    | 开启所有警告信息，帮助发现潜在错误                  | `gcc hello.c -Wall -o hello`    |
| `-Werror`  | 将警告视为错误，强制修正所有警告                    | `gcc hello.c -Werror -o hello`  |
| `-g`       | 生成调试信息，供gdb调试使用（必须加）               | `gcc hello.c -g -o hello`       |
| `-O2`      | 开启二级优化，提升程序运行效率（发布版本用）        | `gcc hello.c -O2 -o hello`      |
| `-std=c99` | 指定C语言标准（如c99、c11）                         | `gcc hello.c -std=c99 -o hello` |
| `-I`       | 指定头文件搜索路径（如自定义头文件在 `./inc` 目录） | `gcc main.c -I./inc -o app`     |
| `-L`       | 指定库文件搜索路径（如自定义库在 `./lib` 目录）     | `gcc main.c -L./lib -lm -o app` |
| `-l`       | 链接指定的库文件（如 `-lm` 链接数学库）             | `gcc calc.c -lm -o calc`        |

## GDB

GDB（GNU Debugger）是Linux下的命令行调试工具，需配合编译时添加的 `-g` 选项使用，核心功能包括断点设置、变量查看、流程控制等。

### 1. 启动与退出GDB

- 启动GDB：`gdb 可执行文件名`，如 `gdb hello`。
- 退出GDB：在GDB命令行中输入 `q` 或 `quit`。
- 运行程序：启动GDB后，输入 `run` 或 `r` 运行程序；若需传参，输入 `r 参数1 参数2`，如 `r 10 20`。

### 2. 断点操作

断点用于暂停程序执行，以便查看变量状态和流程，支持按行号、函数名、条件设置。

- 按行号设断点：`break 行号` 或 `b 行号`，如 `b 10`（在第10行设断点）。
- 按函数名设断点：`break 函数名`，如 `b add`（在 `add` 函数入口设断点）。
- 设条件断点：`break 行号 if 条件`，如 `b 20 if x>100`（仅当 `x>100` 时暂停第20行）。
- 查看所有断点：`info breakpoints` 或 `info b`。
- 删除断点：`delete 断点编号`，如 `delete 1`（删除编号为1的断点）。
- 禁用/启用断点：`disable 断点编号`（禁用）、`enable 断点编号`（启用）。

### 3. 程序流程控制

暂停后通过以下命令控制程序执行，逐步定位问题：

- 单步执行（不进入函数）：`next` 或 `n`，执行当前行后暂停。
- 单步执行（进入函数）：`step` 或 `s`，若当前行是函数调用，进入函数内部执行。
- 继续执行到下一个断点：`continue` 或 `c`。
- 执行到当前函数结束：`finish`，跳出当前函数并暂停。
- 退出当前程序：`kill`，终止正在调试的程序（不退出GDB）。

### 4. 变量与内存查看

调试时需频繁查看变量值、内存数据，常用命令如下：

- 查看变量值：`print 变量名` 或 `p 变量名`，如 `p x`（查看变量 `x` 的值）；支持表达式，如 `p x+y`。
- 实时显示变量：`display 变量名`，后续每步执行后自动显示该变量值；`undisplay 编号` 取消显示。
- 查看内存：`x /nfu 内存地址`，其中 `n` 是数量，`f` 是格式（`x` 十六进制、`d` 十进制），`u` 是单位（`b` 字节、`w` 4字节）。示例：`x /10xw 0x123456`（查看0x123456开始的10个4字节数据，以十六进制显示）。
- 查看数组：`print 数组名@长度`，如 `p arr@5`（查看数组 `arr` 的前5个元素）。

### 5. 其他常用命令

- 查看函数调用栈：`backtrace` 或 `bt`，显示当前程序的函数调用关系（定位崩溃位置常用）。
- 切换栈帧：`frame 栈帧编号`，如 `frame 1`（切换到编号1的栈帧，查看上层函数的变量）。
- 查看源代码：`list` 或 `l`，显示当前执行位置附近的代码；`l 行号` 显示指定行附近的代码。
- 设置变量值：`set var 变量名=值`，如 `set var x=10`（调试时临时修改变量值，验证逻辑）。